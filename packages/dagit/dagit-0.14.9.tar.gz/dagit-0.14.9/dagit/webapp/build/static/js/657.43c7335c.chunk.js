"use strict";(self.webpackChunk_dagster_io_dagit_app=self.webpackChunk_dagster_io_dagit_app||[]).push([[657],{72657:function(n,t,e){var i,a,o,r=e(83975),u=e(99500),s=e(69131),h=e(38608);(0,h.P)({source:function(n){return n.source},target:function(n){return n.target},x:function(n){return n.x},y:function(n){return n.y}});function d(n){return n.path.join(" > ")}var f=(0,s.Ps)(i||(i=(0,u.Z)(["\n  fragment InProgressRunsFragment on InProgressRunsByStep {\n    stepKey\n    unstartedRuns {\n      id\n    }\n    inProgressRuns {\n      id\n    }\n  }\n"]))),p=(0,s.Ps)(a||(a=(0,u.Z)(["\n  fragment LastRunsWarningsFragment on RunStatsByStep {\n    __typename\n    ... on LatestRun {\n      stepKey\n      run {\n        id\n        status\n      }\n    }\n    ... on JobRunsCount {\n      stepKey\n      jobNames\n      count\n      sinceLatestMaterialization\n    }\n  }\n"]))),g=((0,s.Ps)(o||(o=(0,u.Z)(["\n  fragment RepositoryLiveFragment on Repository {\n    id\n    name\n    location {\n      id\n      name\n    }\n    inProgressRunsByStep {\n      ...InProgressRunsFragment\n    }\n    latestRunByStep {\n      __typename\n      ...LastRunsWarningsFragment\n    }\n  }\n  ","\n  ","\n"])),f,p),100),c=!1,m=function(n){return{width:8*d({path:JSON.parse(n)}).length+30,height:30}},y=function(n){var t=95;n.description&&(t+=25);var e=d(n.assetKey);return n.opName&&e!==n.opName&&(t+=25),{width:Math.max(250,8*e.length)+25,height:t}},l=(e(59019),function(n){return"result"!==n.solid.name?"".concat(n.solid.name,":").concat(n.definition.name):n.solid.name}),v=52,x=26,w=13,b=70;function E(n){var t={};return n.forEach((function(n){return n.forEach((function(n){return t[l(n)]=n}))})),Object.values(t)}function N(n,t){var e=new r.graphlib.Graph,i=0,a=100,o=100;t&&(i=Math.max(t.inputs.length,t.outputs.length)*x,a=(o=140)+i),e.setGraph({rankdir:"TB",marginx:o,marginy:a}),e.setDefaultEdgeLabel((function(){return{}}));var u=[],s={};n.forEach((function(n){s[n.name]=!0})),n.forEach((function(n){var t=O(n,{x:0,y:0});e.setNode(n.name,{width:t.bounds.width,height:t.bounds.height}),n.inputs.forEach((function(t){t.dependsOn.forEach((function(i){s[i.solid.name]&&s[n.name]&&(e.setEdge({v:i.solid.name,w:n.name},{weight:1}),u.push({from:{point:{x:0,y:0},opName:i.solid.name,edgeName:i.definition.name},to:{point:{x:0,y:0},opName:n.name,edgeName:t.definition.name}}))}))}))})),r.layout(e);var h={},d={};e.nodes().forEach((function(n){var t=e.node(n);t&&(d[n]=t)}));var f=0,p=0;Object.keys(d).forEach((function(t){var e=d[t],i=n.find((function(n){return n.name===t}));if(i){var a=e.x-e.width/2,o=e.y-e.height/2;h[t]=O(i,{x:a,y:o}),f=Math.max(f,a+e.width),p=Math.max(p,o+e.height)}})),e.edges().forEach((function(n){var t=u.find((function(t){return t.from.opName===n.v&&t.to.opName===n.w})),i=e.edge(n).points;t&&(t.from.point=i[0],t.to.point=i[i.length-1])}));var g={edges:u,nodes:h,width:f+o,height:p+a,parent:null};return t&&(g.parent=function(n,t,e){var i={invocationBoundingBox:{x:1,y:1,width:n.width-1,height:n.height-1},bounds:{x:b,y:b+e,width:n.width-140,height:n.height-2*(b+e)},mappingLeftEdge:50,mappingLeftSpacing:10,inputs:{},outputs:{},dependsOn:R(E(t.inputs.map((function(n){return n.dependsOn}))),-50,n.width),dependedBy:R(E(t.outputs.map((function(n){return n.dependedBy}))),n.height+50,n.width)},a=i.bounds.y+i.bounds.height;return t.inputs.forEach((function(n,t){i.inputs[n.definition.name]={layout:{x:i.bounds.x,y:i.bounds.y-t*x-x,width:0,height:x},port:{x:i.bounds.x+w,y:i.bounds.y-t*x-13}}})),t.outputs.forEach((function(n,t){i.outputs[n.definition.name]={layout:{x:i.bounds.x,y:a+t*x,width:0,height:x},port:{x:i.bounds.x+w,y:a+t*x+13}}})),i}(g,t,i)),g}function R(n,t,e){var i=e-166,a=Math.max(200,i/n.length),o=83+Math.min(0,(i-n.length*a)/2),r=a<300?20:0,u={};return n.forEach((function(n,e){var i=1-e%2*2;u[l(n)]={x:o+e*a,y:t+r*i}})),u}function O(n,t){var e=t.y,i={},a=function(n,i){var a=(370-35*i)/2,o=t.x+35*n+a;return{port:{x:o+w,y:e+13},layout:{x:o,y:e,width:35,height:x}}},o=function(){var n={port:{x:t.x+w,y:e+13},layout:{x:t.x,y:e,width:0,height:x}};return e+=x,n};n.inputs.forEach((function(t,e){i[t.definition.name]=n.inputs.length>4?a(e,n.inputs.length):o()})),n.inputs.length>4&&(e+=x);var r={x:t.x,y:Math.max(t.y,e-0),width:370,height:52};e+=v,n.definition.assetNodes.length&&n.definition.description&&(r.height+=22,e+=22);var u={};return n.outputs.forEach((function(t,e){u[t.definition.name]=n.outputs.length>4?a(e,n.outputs.length):o()})),n.outputs.length>4&&(e+=x),{bounds:{x:t.x-5,y:t.y-5,width:380,height:e-t.y+10},op:r,inputs:i,outputs:u}}var k=self;k.addEventListener("message",(function(n){if("layoutOpGraph"===n.data.type){var t=n.data,e=t.ops,i=t.parentOp;k.postMessage(N(e,i))}else if("layoutAssetGraph"===n.data.type){var a=n.data.graphData;k.postMessage(function(n){var t=new r.graphlib.Graph;t.setGraph({rankdir:"TB",marginx:g,marginy:g,nodesep:c?20:50,edgesep:10,ranksep:c?20:50}),t.setDefaultEdgeLabel((function(){return{}}));var e=function(n){return n&&n.definition.opName};Object.values(n.nodes).filter(e).forEach((function(n){var e=y(n.definition),i=e.width,a=e.height;t.setNode(n.id,{width:c?230:i,height:a})}));var i={};Object.keys(n.downstream).forEach((function(a){Object.keys(n.downstream[a]).forEach((function(o){(e(n.nodes[o])||e(n.nodes[a]))&&(t.setEdge({v:a,w:o},{weight:1}),e(n.nodes[o])?e(n.nodes[a])||(i[a]=!0):i[o]=!0)}))})),Object.keys(i).forEach((function(n){t.setNode(n,m(n))})),r.layout(t);var a={};t.nodes().forEach((function(n){var e=t.node(n);e&&(a[n]=e)}));var o=0,u=0,s={};Object.keys(a).forEach((function(n){var t=a[n];s[n]={id:n,bounds:{x:t.x-t.width/2,y:t.y-t.height/2,width:t.width,height:t.height}},o=Math.max(o,t.x+t.width/2),u=Math.max(u,t.y+t.height/2)}));var h=[];return t.edges().forEach((function(n){var e=t.edge(n).points;h.push({from:e[0],to:e[e.length-1],dashed:!1})})),{nodes:s,edges:h,width:o+g,height:u+g}}(a))}}))}}]);
//# sourceMappingURL=657.43c7335c.chunk.js.map