<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>datalad run &mdash; DataLad 0.15.3+529.gc81453444.dirty documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="datalad status" href="datalad-status.html" />
    <link rel="prev" title="datalad save" href="datalad-save.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> DataLad
            <img src="../../_static/datalad_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.15
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../publications.html">Publications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../background.html">Background and motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../related.html">Delineation from related solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../basics.html">Basic principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credentials.html">Credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../customization.html">Customization and extension of functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/index.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../cmdline.html">Command line reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../cmdline.html#main-command">Main command</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../cmdline.html#core-commands">Core commands</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../cmdline.html#local-operation">Local operation</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="datalad-create.html">datalad create: Create a new dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalad-save.html">datalad save: Save the state of a dataset</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">datalad run: Run a shell command and record its impact on a dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalad-status.html">datalad status: Report on the state of dataset content</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalad-diff.html">datalad diff: Report differences between two states of a dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../cmdline.html#distributed-operation">Distributed operation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cmdline.html#extended-set-of-functionality">Extended set of functionality</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modref.html">Python module reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">Configuration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DataLad</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../cmdline.html">Command line reference</a> &raquo;</li>
      <li>datalad run</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="datalad-run">
<span id="man-datalad-run"></span><h1>datalad run<a class="headerlink" href="#datalad-run" title="Permalink to this headline"></a></h1>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datalad</span> <span class="n">run</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span> <span class="n">DATASET</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">i</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">expand</span> <span class="p">{</span><span class="n">inputs</span><span class="o">|</span><span class="n">outputs</span><span class="o">|</span><span class="n">both</span><span class="p">}]</span>
    <span class="p">[</span><span class="o">--</span><span class="n">assume</span><span class="o">-</span><span class="n">ready</span> <span class="p">{</span><span class="n">inputs</span><span class="o">|</span><span class="n">outputs</span><span class="o">|</span><span class="n">both</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">explicit</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">m</span> <span class="n">MESSAGE</span><span class="p">]</span>
    <span class="p">[</span><span class="o">--</span><span class="n">sidecar</span> <span class="p">{</span><span class="n">yes</span><span class="o">|</span><span class="n">no</span><span class="p">}]</span> <span class="p">[</span><span class="o">--</span><span class="n">dry</span><span class="o">-</span><span class="n">run</span> <span class="p">{</span><span class="n">basic</span><span class="o">|</span><span class="n">command</span><span class="p">}]</span> <span class="p">[</span><span class="o">-</span><span class="n">J</span> <span class="n">NJOBS</span><span class="p">]</span>
    <span class="p">[</span><span class="o">--</span><span class="n">version</span><span class="p">]</span> <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline"></a></h2>
<p>Run an arbitrary shell command and record its impact on a dataset.</p>
<p>It is recommended to craft the command such that it can run in the root
directory of the dataset that the command will be recorded in. However,
as long as the command is executed somewhere underneath the dataset root,
the exact location will be recorded relative to the dataset root.</p>
<p>If the executed command did not alter the dataset in any way, no record of
the command execution is made.</p>
<p>If the given command errors, a COMMANDERROR exception with the same exit
code will be raised, and no modifications will be saved.</p>
<p><em>Command format</em></p>
<p>A few placeholders are supported in the command via Python format
specification. “{pwd}” will be replaced with the full path of the
current working directory. “{dspath}” will be replaced with the full
path of the dataset that run is invoked on. “{tmpdir}” will be
replaced with the full path of a temporary directory. “{inputs}” and
“{outputs}” represent the values specified by –input and –output. If
multiple values are specified, the values will be joined by a space.
The order of the values will match that order from the command line,
with any globs expanded in alphabetical order (like bash). Individual
values can be accessed with an integer index (e.g., “{inputs[0]}”).</p>
<p>Note that the representation of the inputs or outputs in the formatted
command string depends on whether the command is given as a list of
arguments or as a string (quotes surrounding the command). The
concatenated list of inputs or outputs will be surrounded by quotes
when the command is given as a list but not when it is given as a
string. This means that the string form is required if you need to
pass each input as a separate argument to a preceding script (i.e.,
write the command as “./script {inputs}”, quotes included). The string
form should also be used if the input or output paths contain spaces
or other characters that need to be escaped.</p>
<p>To escape a brace character, double it (i.e., “{{” or “}}”).</p>
<p>Custom placeholders can be added as configuration variables under
“datalad.run.substitutions”.  As an example:</p>
<blockquote>
<div><p>Add a placeholder “name” with the value “joe”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="n">file</span><span class="o">=.</span><span class="n">datalad</span><span class="o">/</span><span class="n">config</span> <span class="n">datalad</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">substitutions</span><span class="o">.</span><span class="n">name</span> <span class="n">joe</span>
<span class="o">%</span> <span class="n">datalad</span> <span class="n">save</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Configure name placeholder&quot;</span> <span class="o">.</span><span class="n">datalad</span><span class="o">/</span><span class="n">config</span>
</pre></div>
</div>
<p>Access the new placeholder in a command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">datalad</span> <span class="n">run</span> <span class="s2">&quot;echo my name is </span><span class="si">{name}</span><span class="s2"> &gt;me&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p><em>Examples</em></p>
<p>Run an executable script and record the impact on a dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">datalad</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;run my script&#39;</span> <span class="s1">&#39;code/script.sh&#39;</span>
</pre></div>
</div>
<p>Run a command and specify a directory as a dependency for the run. The
contents of the dependency will be retrieved prior to running the
script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">datalad</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;run my script&#39;</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;data/*&#39;</span> <span class="s1">&#39;code/script.sh&#39;</span>
</pre></div>
</div>
<p>Run an executable script and specify output files of the script to be
unlocked prior to running the script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">datalad</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;run my script&#39;</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;data/*&#39;</span> \
  <span class="o">-</span><span class="n">o</span> <span class="s1">&#39;output_dir/*&#39;</span> <span class="s1">&#39;code/script.sh&#39;</span>
</pre></div>
</div>
<p>Specify multiple inputs and outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">datalad</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;run my script&#39;</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;data/*&#39;</span> \
  <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;datafile.txt&#39;</span> <span class="o">-</span><span class="n">o</span> <span class="s1">&#39;output_dir/*&#39;</span> <span class="o">-</span><span class="n">o</span> \
  <span class="s1">&#39;outfile.txt&#39;</span> <span class="s1">&#39;code/script.sh&#39;</span>
</pre></div>
</div>
<p>Use ** to match any file at any directory depth recursively. Single *
does not check files within matched directories.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">datalad</span> <span class="n">run</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;run my script&#39;</span> <span class="o">-</span><span class="n">i</span> <span class="s1">&#39;data/**/*.dat&#39;</span> \
  <span class="o">-</span><span class="n">o</span> <span class="s1">&#39;output_dir/**&#39;</span> <span class="s1">&#39;code/script.sh&#39;</span>
</pre></div>
</div>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline"></a></h2>
<section id="command">
<h3>COMMAND<a class="headerlink" href="#command" title="Permalink to this headline"></a></h3>
<p>command for execution. A leading ‘–’ can be used to disambiguate this command from the preceding options to DataLad.</p>
</section>
<section id="h-help-help-np">
<h3><strong>-h</strong>, <strong>-\-help</strong>, <strong>-\-help-np</strong><a class="headerlink" href="#h-help-help-np" title="Permalink to this headline"></a></h3>
<p>show this help message. –help-np forcefully disables the use of a pager for displaying the help message</p>
</section>
<section id="d-dataset-dataset-dataset">
<h3><strong>-d</strong> <em>DATASET</em>, <strong>-\-dataset</strong> <em>DATASET</em><a class="headerlink" href="#d-dataset-dataset-dataset" title="Permalink to this headline"></a></h3>
<p>specify the dataset to record the command results in. An attempt is made to identify the dataset based on the current working directory. If a dataset is given, the command will be executed in the root directory of this dataset. Constraints: Value must be a Dataset or a valid identifier of a Dataset (e.g. a path)</p>
</section>
<section id="i-path-input-path">
<h3><strong>-i</strong> PATH, <strong>-\-input</strong> PATH<a class="headerlink" href="#i-path-input-path" title="Permalink to this headline"></a></h3>
<p>A dependency for the run. Before running the command, the content of this file will be retrieved. A value of “.” means “run datalad get .”. The value can also be a glob. This option can be given more than once.</p>
</section>
<section id="o-path-output-path">
<h3><strong>-o</strong> PATH, <strong>-\-output</strong> PATH<a class="headerlink" href="#o-path-output-path" title="Permalink to this headline"></a></h3>
<p>Prepare this file to be an output file of the command. A value of “.” means “run datalad unlock .” (and will fail if some content isn’t present). For any other value, if the content of this file is present, unlock the file. Otherwise, remove it. The value can also be a glob. This option can be given more than once.</p>
</section>
<section id="expand-inputs-outputs-both">
<h3><strong>-\-expand</strong> {inputs|outputs|both}<a class="headerlink" href="#expand-inputs-outputs-both" title="Permalink to this headline"></a></h3>
<p>Expand globs when storing inputs and/or outputs in the commit message. Constraints: value must be one of (‘inputs’, ‘outputs’, ‘both’)</p>
</section>
<section id="assume-ready-inputs-outputs-both">
<h3><strong>-\-assume-ready</strong> {inputs|outputs|both}<a class="headerlink" href="#assume-ready-inputs-outputs-both" title="Permalink to this headline"></a></h3>
<p>Assume that inputs do not need to be retrieved and/or outputs do not need to unlocked or removed before running the command. This option allows you to avoid the expense of these preparation steps if you know that they are unnecessary. Constraints: value must be one of (‘inputs’, ‘outputs’, ‘both’)</p>
</section>
<section id="explicit">
<h3><strong>-\-explicit</strong><a class="headerlink" href="#explicit" title="Permalink to this headline"></a></h3>
<p>Consider the specification of inputs and outputs to be explicit. Don’t warn if the repository is dirty, and only save modifications to the listed outputs.</p>
</section>
<section id="m-message-message-message">
<h3><strong>-m</strong> MESSAGE, <strong>-\-message</strong> MESSAGE<a class="headerlink" href="#m-message-message-message" title="Permalink to this headline"></a></h3>
<p>a description of the state or the changes made to a dataset. Constraints: value must be a string</p>
</section>
<section id="sidecar-yes-no">
<h3><strong>-\-sidecar</strong> {yes|no}<a class="headerlink" href="#sidecar-yes-no" title="Permalink to this headline"></a></h3>
<p>By default, the configuration variable ‘datalad.run.record-sidecar’ determines whether a record with information on a command’s execution is placed into a separate record file instead of the commit message (default: off). This option can be used to override the configured behavior on a case-by-case basis. Sidecar files are placed into the dataset’s ‘.datalad/runinfo’ directory (customizable via the ‘datalad.run.record-directory’ configuration variable). Constraints: value must be NONE, or value must be convertible to type bool</p>
</section>
<section id="dry-run-basic-command">
<h3><strong>-\-dry-run</strong> {basic|command}<a class="headerlink" href="#dry-run-basic-command" title="Permalink to this headline"></a></h3>
<p>Do not run the command; just display details about the command execution. A value of “basic” reports a few important details about the execution, including the expanded command and expanded inputs and outputs. “command” displays the expanded command only. Note that input and output globs underneath an uninstalled dataset will be left unexpanded because no subdatasets will be installed for a dry run. Constraints: value must be one of (‘basic’, ‘command’)</p>
</section>
<section id="j-njobs-jobs-njobs">
<h3><strong>-J</strong> NJOBS, <strong>-\-jobs</strong> NJOBS<a class="headerlink" href="#j-njobs-jobs-njobs" title="Permalink to this headline"></a></h3>
<p>how many parallel jobs (where possible) to use. “auto” corresponds to the number defined by ‘datalad.runtime.max-annex-jobs’ configuration item NOTE: This option can only parallelize input retrieval (get) and output recording (save). DataLad does NOT parallelize your scripts for you. Constraints: value must be convertible to type ‘int’, or value must be one of (‘auto’,)</p>
</section>
<section id="version">
<h3><strong>-\-version</strong><a class="headerlink" href="#version" title="Permalink to this headline"></a></h3>
<p>show the module and its version which provides the command</p>
</section>
</section>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Permalink to this headline"></a></h2>
<p>datalad is developed by The DataLad Team and Contributors &lt;<a class="reference external" href="mailto:team&#37;&#52;&#48;datalad&#46;org">team<span>&#64;</span>datalad<span>&#46;</span>org</a>&gt;.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="datalad-save.html" class="btn btn-neutral float-left" title="datalad save" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="datalad-status.html" class="btn btn-neutral float-right" title="datalad status" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, DataLad team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>