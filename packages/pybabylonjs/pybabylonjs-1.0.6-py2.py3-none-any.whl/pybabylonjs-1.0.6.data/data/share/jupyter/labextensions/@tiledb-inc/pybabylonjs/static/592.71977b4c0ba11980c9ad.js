"use strict";(self.webpackChunk_tiledb_inc_pybabylonjs=self.webpackChunk_tiledb_inc_pybabylonjs||[]).push([[592],{8657:(e,t,n)=>{n.d(t,{Y:()=>s,o:()=>r});const i=n(4147),s=i.version,r=i.name},5592:(e,t,n)=>{n.r(t),n.d(t,{BabylonBaseModel:()=>w,BabylonGroundModel:()=>I,BabylonGroundView:()=>B,BabylonMBRSModel:()=>P,BabylonMBRSView:()=>O,BabylonPCModel:()=>x,BabylonPCView:()=>C});var i=n(8233),s=n(8657),r=n(2752),a=n(2759),o=(n(9559),n(7792),n(7924),n(3379)),l=n.n(o),c=n(7795),d=n.n(c),u=n(569),h=n.n(u),p=n(3565),b=n.n(p),m=n(9216),v=n.n(m),y=n(4589),g=n.n(y),_=n(3889),f={};f.styleTagTransform=g(),f.setAttributes=b(),f.insert=h().bind(null,"head"),f.domAPI=d(),f.insertStyleElement=v(),l()(_.Z,f),_.Z&&_.Z.locals&&_.Z.locals;class w extends i.DOMWidgetModel{}w.model_module=s.o,w.model_module_version=s.Y,w.view_module=s.o,w.view_module_version=s.Y,w.serializers=Object.assign({},i.DOMWidgetModel.serializers);class S extends i.DOMWidgetView{constructor(){super(...arguments),this.values=this.model.get("value"),this.width=this.values.width,this.height=this.values.height,this.wheelPrecision=this.values.wheel_precision,this.zScale=this.values.z_scale,this.inspector=this.values.inspector}resizeCanvas(){var e,t,n;null===(e=this.canvas)||void 0===e||e.setAttribute("width",this.width),null===(t=this.canvas)||void 0===t||t.setAttribute("height",this.height),null===(n=this.engine)||void 0===n||n.resize()}query_changed(){}render(){this.canvas=document.createElement("canvas"),this.canvas.classList.add("renderCanvas"),this.el.appendChild(this.canvas),this.model.on("change:query",this.query_changed,this),this.model.on_some_change(["width","height"],this.resizeCanvas,this),this.engine=new r.Engine(this.canvas,!0);const e=this.engine;r.SceneLoader.ShowLoadingScreen=!1,this.resizeCanvas(),this.createScene().then((t=>{e.runRenderLoop((()=>{t.render()}))}))}async createScene(){const e=new r.Scene(this.engine);return this.inspector&&e.debugLayer.show({embedMode:!0}),e}}class x extends w{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:x.model_name,_model_module:x.model_module,_model_module_version:x.model_module_version,_view_name:x.view_name,_view_module:x.view_module,_view_module_version:x.view_module_version})}}x.model_name="BabylonPCModel",x.view_name="BabylonPCView";class C extends S{async createScene(){return super.createScene().then((e=>{const t=this.values.data,n=t.X.length,i=this.values.gltf_data,s=this.values.point_size,o=this.values.time,l=t.GpsTime,c=this.values.time_offset,d=this.values.classes,u=this.values.class_numbers,h=this.values.class_names,p=this.zScale;var b=!1;if(d)var m=new r.PointsCloudSystem("pcs",s,e,{updatable:d});else m=new r.PointsCloudSystem("pcs",s,e,{updatable:o});m.addPoints(n,(function(n,i,s){n.position=new r.Vector3(t.X[i],t.Z[i]*p,t.Y[i]),n.color=o?e.clearColor:new r.Color3(t.Red[i],t.Green[i],t.Blue[i])}));let v=[m.buildMeshAsync()];if(i){var y=new Blob([i]),g=URL.createObjectURL(y);v.push(r.SceneLoader.AppendAsync(g,"",e,null,".gltf"))}return Promise.all(v).then((()=>{if(e.createDefaultCameraOrLight(!0,!0,!1),o||d){var i=a.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,e),s=new a.StackPanel;s.width="220px",s.horizontalAlignment=a.Control.HORIZONTAL_ALIGNMENT_CENTER,s.verticalAlignment=a.Control.VERTICAL_ALIGNMENT_BOTTOM,i.addControl(s);var p=new a.TextBlock;p.height="30px",p.color="white";var v=new a.Slider("Slider");if(v.minimum=0,v.step=1,v.height="20px",v.width="200px",o&&(p.text="Time: "+(c+l[0]).toFixed(2),v.maximum=t.GpsTime.length-1,v.value=0),d){p.text="All";var y=Array.from(new Set(t.Class));v.maximum=y.length,v.value=y[0]}s.addControl(p),m.updateParticle=function(n){return n.color=b?e.clearColor:new r.Color3(t.Red[n.idx],t.Green[n.idx],t.Blue[n.idx]),n},v.onValueChangedObservable.add((function(e){if(o&&(p.text="Time: "+(c+l[e]).toFixed(2),e>m.counter?(b=!1,m.setParticles(m.counter,e)):(b=!0,m.setParticles(e,m.counter)),m.counter=e),d){var i=u.indexOf(y[e]);p.text=h[i];var s=t.Class.indexOf(y[e]),r=t.Class.lastIndexOf(y[e]);b=!0,m.setParticles(0,n),b=!1,m.setParticles(s,r)}})),s.addControl(v)}let g=e.activeCamera;return g.panningAxis=new r.Vector3(1,1,0),g.upperBetaLimit=Math.PI/2,g.panningSensibility=1,g.panningInertia=.2,g._panningMouseButton=0,this.wheelPrecision>0&&(g.wheelPrecision=this.wheelPrecision),g.alpha+=Math.PI,g.attachControl(this.canvas,!0),e}))}))}}class P extends w{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:P.model_name,_model_module:P.model_module,_model_module_version:P.model_module_version,_view_name:P.view_name,_view_module:P.view_module,_view_module_version:P.view_module_version})}}P.model_name="BabylonMBRSModel",P.view_name="BabylonMBRSView";class O extends S{async createScene(){return super.createScene().then((e=>{const t=this.values.data,n=this.values.extents,i=n[0],s=n[1],a=n[2],o=n[3],l=n[4],c=n[5],d=this.zScale;var u=new r.StandardMaterial("mt1",e);u.alpha=.9;const h=new r.SolidParticleSystem("SPS",e),p=r.MeshBuilder.CreateBox("b",{height:1,width:1,depth:1});h.addShape(p,t.Xmin.length),p.dispose(),h.buildMesh(),h.initParticles=()=>{for(let e=0;e<h.nbParticles;e++){const n=h.particles[e];n.position.x=((t.Xmax[e]+t.Xmin[e])/2-i)/(s-i),n.position.y=((t.Ymax[e]+t.Ymin[e])/2-a)/(o-a),n.position.z=((t.Zmax[e]+t.Zmin[e])/2-l)/(c-l)*d,n.scaling.x=(t.Xmax[e]-t.Xmin[e])/(s-i),n.scaling.y=(t.Ymax[e]-t.Ymin[e])/(o-a),n.scaling.z=(t.Zmax[e]-t.Zmin[e])/(c-l)*d,n.color=new r.Color4(.5+.6*Math.random(),.5+.6*Math.random(),.5+.6*Math.random(),.9)}},h.mesh.hasVertexAlpha=!0,h.initParticles(),h.setParticles(),h.mesh.material=u,e.createDefaultCameraOrLight(!0,!0,!0);let b=e.activeCamera;return b.wheelPrecision=this.wheelPrecision,b.alpha+=Math.PI,e}))}}class I extends w{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:I.model_name,_model_module:I.model_module,_model_module_version:I.model_module_version,_view_name:I.view_name,_view_module:I.view_module,_view_module_version:I.view_module_version})}}I.model_name="BabylonGroundModel",I.view_name="BabylonGroundView";class B extends S{async createScene(){return super.createScene().then((e=>{const t=this.values.data,n=this.values.img_height,i=this.values.img_width;e.createDefaultCameraOrLight(!0,!0,!0),e.clearColor=new r.Color4(.95,.94,.92,1);var s=new Blob([t]),a=URL.createObjectURL(s);const o=new r.StandardMaterial("ground",e);o.diffuseTexture=new r.Texture(a,e),o.ambientTexture=new r.Texture(a,e),o.ambientColor=new r.Color3(.5,.5,.5),o.diffuseColor=new r.Color3(.8,.8,.8),o.specularColor=new r.Color3(.5,.5,.5),o.specularPower=32,r.MeshBuilder.CreateGround("ground",{height:.005*n,width:.005*i,subdivisions:16},e).material=o;let l=e.activeCamera;return l.panningAxis=new r.Vector3(1,1,0),l.upperBetaLimit=Math.PI/2,l.panningSensibility=1,l.panningInertia=.2,l._panningMouseButton=0,this.wheelPrecision>0&&(l.wheelPrecision=this.wheelPrecision),l.alpha+=Math.PI,l.attachControl(this.canvas,!0),e}))}}},7792:(e,t,n)=>{n.d(t,{X:()=>i,b:()=>d});var i,s=n(655),r=n(8810),a=n(475),o=n(6814),l=n(661),c=n(2733);Object.defineProperty(o.x.prototype,"debugLayer",{get:function(){return this._debugLayer||(this._debugLayer=new d(this)),this._debugLayer},enumerable:!0,configurable:!0}),function(e){e[e.Properties=0]="Properties",e[e.Debug=1]="Debug",e[e.Statistics=2]="Statistics",e[e.Tools=3]="Tools",e[e.Settings=4]="Settings"}(i||(i={}));var d=function(){function e(e){var t=this;this.BJSINSPECTOR=this._getGlobalInspector(),this._scene=e||c.l.LastCreatedScene,this._scene&&this._scene.onDisposeObservable.add((function(){t._scene._debugLayer&&t._scene._debugLayer.hide()}))}return Object.defineProperty(e.prototype,"onPropertyChangedObservable",{get:function(){return this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector?this.BJSINSPECTOR.Inspector.OnPropertyChangedObservable:(this._onPropertyChangedObservable||(this._onPropertyChangedObservable=new a.y$),this._onPropertyChangedObservable)},enumerable:!1,configurable:!0}),e.prototype._createInspector=function(e){if(!this.isVisible()){if(this._onPropertyChangedObservable){for(var t=0,n=this._onPropertyChangedObservable.observers;t<n.length;t++){var i=n[t];this.BJSINSPECTOR.Inspector.OnPropertyChangedObservable.add(i)}this._onPropertyChangedObservable.clear(),this._onPropertyChangedObservable=void 0}var r=(0,s.pi)({overlay:!1,showExplorer:!0,showInspector:!0,embedMode:!1,handleResize:!0,enablePopup:!0},e);this.BJSINSPECTOR=this.BJSINSPECTOR||this._getGlobalInspector(),this.BJSINSPECTOR.Inspector.Show(this._scene,r)}},e.prototype.select=function(e,t){this.BJSINSPECTOR&&(t&&("[object String]"==Object.prototype.toString.call(t)?this.BJSINSPECTOR.Inspector.MarkLineContainerTitleForHighlighting(t):this.BJSINSPECTOR.Inspector.MarkMultipleLineContainerTitlesForHighlighting(t)),this.BJSINSPECTOR.Inspector.OnSelectionChangeObservable.notifyObservers(e))},e.prototype._getGlobalInspector=function(){return"undefined"!=typeof INSPECTOR?INSPECTOR:"undefined"!=typeof BABYLON&&void 0!==BABYLON.Inspector?BABYLON:void 0},e.prototype.isVisible=function(){return this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector.IsVisible},e.prototype.hide=function(){this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector.Hide()},e.prototype.setAsActiveScene=function(){this.BJSINSPECTOR&&this.BJSINSPECTOR.Inspector._SetNewScene(this._scene)},e.prototype.show=function(t){var n=this;return new Promise((function(i){if(void 0===n.BJSINSPECTOR){var s=t&&t.inspectorURL?t.inspectorURL:e.InspectorURL;r.w1.LoadScript(s,(function(){n._createInspector(t),i(n)}))}else n._createInspector(t),i(n)}))},e.InspectorURL="https://unpkg.com/babylonjs-inspector@".concat(l.D.Version,"/babylon.inspector.bundle.js"),e}()},3889:(e,t,n)=>{n.d(t,{Z:()=>o});var i=n(8081),s=n.n(i),r=n(3645),a=n.n(r)()(s());a.push([e.id,"#renderCanvas {\n  width: 100%;\n  height: 100%;\n  touch-action: none;\n}\n",""]);const o=a},3645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,s,r){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);i&&a[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),t.push(d))}},t}},8081:e=>{e.exports=function(e){return e[1]}},3379:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var r={},a=[],o=0;o<e.length;o++){var l=e[o],c=i.base?l[0]+i.base:l[0],d=r[c]||0,u="".concat(c," ").concat(d);r[c]=d+1;var h=n(u),p={css:l[1],media:l[2],sourceMap:l[3]};-1!==h?(t[h].references++,t[h].updater(p)):t.push({identifier:u,updater:s(p,i),references:1}),a.push(u)}return a}function s(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n.update(e=t)}else n.remove()}}e.exports=function(e,s){var r=i(e=e||[],s=s||{});return function(e){e=e||[];for(var a=0;a<r.length;a++){var o=n(r[a]);t[o].references--}for(var l=i(e,s),c=0;c<r.length;c++){var d=n(r[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}r=l}}},569:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t),t}},3565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i=n.css,s=n.media,r=n.sourceMap;s?e.setAttribute("media",s):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},4147:e=>{e.exports=JSON.parse('{"name":"@tiledb-inc/pybabylonjs","version":"1.0.6","description":"BabylonJS widget","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css","style/*.css","style/index.js"],"author":{"name":"TileDB","email":"support@tiledb.com"},"homepage":"https://github.com/TileDB-Inc/PyBabylonJS","bugs":{"url":"https://github.com/TileDB-Inc/PyBabylonJS/issues"},"license":"MIT","main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/TileDB-Inc/PyBabylonJS"},"scripts":{"build":"jlpm run build:lib && jlpm run build:labextension:dev","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc","build:dist":"NODE_OPTIONS=--max-old-space-size=4096 webpack --mode=production","build:prod":"jlpm run clean && jlpm run build:lib && jlpm run build:labextension && jlpm run build:dist","clean":"jlpm run clean:lib","clean:lib":"rimraf lib tsconfig.tsbuildinfo","clean:labextension":"rimraf pybabylonjs/labextension","clean:all":"jlpm run clean:lib && jlpm run clean:labextension","clean:nbextension":"rimraf pybabylonjs/nbextension/static/index.js","eslint":"eslint . --ext .ts,.tsx --fix","eslint:check":"eslint . --ext .ts,.tsx","install:extension":"jlpm run build","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"yarn run build:lib","test":"echo test","watch":"run-p watch:src watch:labextension","watch:src":"tsc -w","watch:labextension":"jupyter labextension watch .","watch:lib":"tsc -w","watch:nbextension":"NODE_OPTIONS=--max-old-space-size=4096 webpack --watch --mode=development"},"dependencies":{"@babylonjs/core":"^5.0.0","babylonjs-materials":"^5.0.0","@babylonjs/inspector":"^5.0.0","@babylonjs/loaders":"^5.0.0","@jupyter-widgets/base":"^1.1.10 || ^2 || ^3 || ^4","@jupyterlab/application":"^3.2.0","@tiledb-inc/tiledb-cloud":"^0.0.8","babylonjs-gui":"^4.2.1"},"devDependencies":{"@jupyterlab/builder":"^3.1.0","@types/node":"^10.11.6","@types/webpack-env":"^1.16.3","@typescript-eslint/eslint-plugin":"^4.8.1","@typescript-eslint/parser":"^4.8.1","crypto":"1.0.1","css-loader":"^6.3.0","eslint":"^7.14.0","eslint-config-prettier":"^6.15.0","eslint-plugin-prettier":"^3.1.4","expect.js":"^0.3.1","fs-extra":"^7.0.0","git-tag-version":"^1.3.1","mkdirp":"^0.5.1","npm-run-all":"^4.1.5","prettier":"^2.1.1","rimraf":"^3.0.2","source-map-loader":"^3.0.0","style-loader":"^3.2.1","svg-url-loader":"^7.1.1","ts-loader":"^9.2.5","typescript":"~4.1.3","webpack":"^5.53.0","webpack-cli":"^4.8.0"},"jupyterlab":{"extension":"lib/plugin","outputDir":"pybabylonjs/labextension"},"styleModule":"style/index.js"}')}}]);