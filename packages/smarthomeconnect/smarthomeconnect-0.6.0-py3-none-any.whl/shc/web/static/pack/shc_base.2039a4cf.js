parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"YwQ1":[function(require,module,exports) {
function t(t,n){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=e(t))||n&&t&&"number"==typeof t.length){o&&(t=o);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==o.return||o.return()}finally{if(c)throw a}}}}function e(t,e){if(t){if("string"==typeof t)return n(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function o(t){if(t.startsWith("/")){var e=window.location;return("https:"===e.protocol?"wss:":"ws:")+"//"+e.host+t}var n=new URL(t);return"https:"===n.protocol?n.protocol="wss:":n.protocol="ws:",n.href}function r(t,e){var n=e(t);if(!1===n)return!1;for(t=t.firstChild;t;){if(!1===(n=r(t,e)))return!1;t=t.nextSibling}}function i(t,e){$(t).closest(".checkbox").checkbox();var n=this;this.subscribeIds=[parseInt(t.getAttribute("data-id"))];var o=t.getAttribute("data-confirm")?t.getAttribute("data-confirm").split(",").map(function(t){return parseInt(t)}):[],r=t.getAttribute("data-confirm-message");this.update=function(e,n){t.checked=e},t.addEventListener("change",function(t){if(-1!==o.indexOf(1*t.target.checked)){if(t.target.checked=!t.target.checked,!window.confirm(r||"Are you sure?"))return;t.target.checked=!t.target.checked}e(n.subscribeIds[0],t.target.checked)})}function a(t,e){var n=this,o=$(t).closest(".dropdown"),r=!1;o.dropdown({onChange:function(t,o,i){r||e(n.subscribeIds[0],JSON.parse(t))}}),this.subscribeIds=[parseInt(t.getAttribute("data-id"))],this.update=function(t,e){r=!0,o.dropdown("set selected",JSON.stringify(t)),r=!1}}function s(e,n){var o=parseInt(e.getAttribute("data-id")),r="True"===e.getAttribute("data-stateful"),i=e.getAttribute("data-confirm")?e.getAttribute("data-confirm").split(",").map(function(t){return parseInt(t)}):[],a=e.getAttribute("data-confirm-message"),s=e.getAttribute("data-on-class")?e.getAttribute("data-on-class").split(" "):[],c=e.getAttribute("data-off-class")?e.getAttribute("data-off-class").split(" "):[],u=!("false"==(e.getAttribute("data-send")||"")),d=!1;this.subscribeIds=[],r&&this.subscribeIds.push(o),this.update=function(n,o){d=n;var r,i=t(s);try{for(i.s();!(r=i.n()).done;){var a=r.value;e.classList.toggle(a,n)}}catch(b){i.e(b)}finally{i.f()}var u,l=t(c);try{for(l.s();!(u=l.n()).done;){var f=u.value;e.classList.toggle(f,!n)}}catch(b){l.e(b)}finally{l.f()}e.classList.remove("loading","active")},u&&e.addEventListener("click",function(t){var s=!d;(-1===i.indexOf(1*s)||window.confirm(a||"Are you sure?"))&&(n(o,s),r&&e.classList.add("active"))})}function c(t,e){this.subscribeIds=[parseInt(t.getAttribute("data-id"))],this.update=function(e,n){t.innerHTML=e}}function u(t,e){var n=parseInt(t.getAttribute("data-id"));this.subscribeIds=[n];var o=null,r=null,i=!1;function a(){i=!0,t.blur(),i=!1,t.value=o}this.update=function(e,n){o=e,document.activeElement!==t&&(t.value=e)},t.addEventListener("blur",function(o){i||e(n,t.value)}),t.addEventListener("keydown",function(e){if(clearTimeout(r),13===e.keyCode)return t.blur(),void e.preventDefault();27!==e.keyCode?r=setTimeout(a,8e3):a()}),t.addEventListener("mousedown",function(t){clearTimeout(r),r=setTimeout(a,8e3)})}function d(t,e){var n=parseInt(t.getAttribute("data-id"));this.subscribeIds=[n];var o=$(t),i=!1;o.slider({min:0,max:1e3,step:1,showLabelTicks:!0,labelDistance:200,interpretLabel:function(t){return t%250==0?Math.round(t/10).toString()+" %":""},onChange:function(){i||e(n,o.slider("get value")/1e3)}});var a=null;r(t.parentNode,function(t){if(1===t.nodeType&&t.classList.contains("value-display"))return a=t,!1}),this.update=function(t,e){i=!0,o.slider("set value",Math.round(1e3*t)),a.textContent=Math.round(100*t).toString()+" %",i=!1}}function l(t,e){var n=parseInt(t.getAttribute("data-id"));this.subscribeIds=[n];var o=new iro.ColorPicker(t,{color:"#000"});o.on("input:end",function(t){e(n,[t.red,t.green,t.blue])}),this.update=function(t,e){o.color.rgb={r:t[0],g:t[1],b:t[2]}}}function f(e,n){var o=parseInt(e.getAttribute("data-id"));this.subscribeIds=[o];var r,i=t(e.parentNode.childNodes.values());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(1===a.nodeType&&a.classList.contains("value-display")){a;break}}}catch(s){i.e(s)}finally{i.f()}this.update=function(t,n){t===e.classList.contains("hidden")&&$(e).transition("zoom "+(t?"in":"out"))}}var b=new Map([["switch",i],["select",a],["button",s],["text-display",c],["text-input",u],["slider",d],["colorchoser",l],["hiderow",f]]);!function(){var e,n=new Map,r=null,i=!1;function a(){console.info("Intializing Smart Home Connect web UI.");var a,d=t(document.querySelectorAll("[data-widget]"));try{for(d.s();!(a=d.n()).done;){var l,f=a.value,p=f.getAttribute("data-widget"),g=new(b.get(p))(f,u),v=t(g.subscribeIds);try{for(v.s();!(l=v.n()).done;){var h=l.value;n.set(h,g)}}catch(m){v.e(m)}finally{v.f()}}}catch(m){d.e(m)}finally{d.f()}!function t(){console.info("Opening websocket ...");e=new WebSocket(o(shcRootURL+"/ws"));e.onopen=s;e.onmessage=c;e.onclose=function(e){console.info("Socket is closed. Reconnect will be attempted in 1 second.",e.reason),r||(r=$("body").toast({message:i?"Connection to websocket server failed ...":"Connection to SHC server lost ...",class:"error",showIcon:"exclamation circle",displayTime:0,closeOnClick:!1})),setTimeout(function(){t()},1e3)};e.onerror=function(t){console.error("Socket encountered error: ",t.message,"Closing socket"),e.close()}}()}function s(){r&&(r.toast("close"),r=null),console.info("Websocket opened. Subscribing widget values ..."),e.send(JSON.stringify({serverToken:shcServerToken}));var o,i=t(n.keys());try{for(i.s();!(o=i.n()).done;){var a=o.value;e.send(JSON.stringify({sub:!0,id:a}))}}catch(s){i.e(s)}finally{i.f()}}function c(t){console.debug("Received message "+t.data);var e=JSON.parse(t.data);e.reload?(console.debug("Reloading page, because server told us to do so."),location.reload()):e.id?(console.debug("Updating widget id "+e.id.toString()+" ..."),n.get(e.id).update(e.v,e.id)):console.error("Don't know how to handle websocket message ",e)}function u(t,n){console.debug("Writing new value "+JSON.stringify(n)+" for widget id "+t.toString());try{if(!e)throw"Websocket not available";if(e.readyState!==WebSocket.OPEN)throw"Websocket is not open.";e.send(JSON.stringify({id:t,v:n}))}catch(o){console.error("Error while sending value via websocket:",o),$("body").toast({message:"Error while sending value.",class:"warning",showIcon:"exclamation circle"})}}document.addEventListener("DOMContentLoaded",function(t){return a()})}(),$(function(){$(".main-menu .ui.dropdown").dropdown(),$(".ui.sidebar").sidebar({transition:"overlay"}).sidebar("attach events","#mobile_item"),$(".shc.image-container .with-popup>*").each(function(){$(this).popup({on:"click",popup:$(this).parent().attr("data-popup-id"),position:$(this).parent().attr("data-popup-position"),movePopup:!1,forcePosition:!0})})});
},{}]},{},["YwQ1"], null)
//# sourceMappingURL=shc_base.2039a4cf.js.map