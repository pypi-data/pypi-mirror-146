"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_alerts_list_index_tsx"],{"./app/components/onboardingPanel.tsx":(t,e,s)=>{s.d(e,{Z:()=>c});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/react/index.js"),s("./app/components/panels/index.tsx")),i=s("./app/styles/space.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(t){let{className:e,image:s,children:a}=t;return(0,r.tZ)(n.s_,{className:e,children:(0,r.BX)(l,{children:[(0,r.tZ)(p,{children:s}),(0,r.tZ)(d,{children:a})]})})}o.displayName="OnboardingPanel";const l=(0,a.Z)("div",{target:"e19tujos2"})("padding:",(0,i.Z)(3),";position:relative;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width: ",(t=>t.theme.breakpoints[1]),"){min-height:350px;}"),d=(0,a.Z)("div",{target:"e19tujos1"})("z-index:1;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){flex:2;}"),p=(0,a.Z)(d,{target:"e19tujos0"})("position:relative;min-height:100px;max-width:300px;margin:",(0,i.Z)(2)," auto;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){flex:1;margin:",(0,i.Z)(3),";max-width:auto;}"),c=o},"./app/views/alerts/list/index.tsx":(t,e,s)=>{s.r(e),s.d(e,{default:()=>C});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),r=s("./app/actionCreators/prompts.tsx"),o=s("./app/components/acl/feature.tsx"),l=s("./app/components/alert.tsx"),d=s("./app/components/asyncComponent.tsx"),p=s("./app/components/button.tsx"),c=s("./app/components/createAlertButton.tsx"),m=s("./app/components/layouts/thirds.tsx"),h=s("./app/components/links/externalLink.tsx"),u=s("./app/components/organizations/pageFilters/container.tsx"),g=s("./app/components/pagination.tsx"),x=s("./app/components/panels/index.tsx"),Z=s("./app/components/sentryDocumentTitle.tsx"),v=s("./app/locale.tsx"),y=s("./app/styles/space.tsx"),w=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),b=s("./app/utils/projects.tsx"),f=s("./app/utils/withOrganization.tsx"),S=s("./app/views/alerts/filterBar.tsx"),_=s("./app/views/alerts/utils/index.tsx"),j=s("./app/views/alerts/list/header.tsx"),A=s("./images/spot/alerts-empty-state.svg"),E=s("./app/components/buttonBar.tsx"),X=s("./app/components/onboardingPanel.tsx"),z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function L(t){let{actions:e}=t;return(0,z.BX)(X.Z,{image:(0,z.tZ)(N,{src:A}),children:[(0,z.tZ)("h3",{children:(0,v.t)("More signal, less noise")}),(0,z.tZ)("p",{children:(0,v.t)("Not every error is worth an email. Set your own rules for alerts you need, with information that helps.")}),(0,z.tZ)(k,{gap:1,children:e})]})}L.displayName="Onboarding";const N=(0,n.Z)("img",{target:"evp2sp81"})("@media (min-width: ",(t=>t.theme.breakpoints[0]),"){user-select:none;position:absolute;top:0;bottom:0;width:220px;margin-top:auto;margin-bottom:auto;transform:translateX(-50%);left:50%;}@media (min-width: ",(t=>t.theme.breakpoints[2]),"){transform:translateX(-60%);width:280px;}@media (min-width: ",(t=>t.theme.breakpoints[3]),"){transform:translateX(-75%);width:320px;}"),k=(0,n.Z)(E.ZP,{target:"evp2sp80"})({name:"vpj881",styles:"grid-template-columns:repeat(auto-fit, minmax(130px, max-content))"}),D=L;var T=s("./app/views/alerts/list/row.tsx");const H="https://docs.sentry.io/workflow/alerts-notifications/alerts/?_ga=2.21848383.580096147.1592364314-1444595810.1582160976";class O extends d.Z{constructor(){super(...arguments),(0,a.Z)(this,"handleChangeSearch",(t=>{const{router:e,location:s}=this.props,{cursor:a,page:n,...i}=s.query;e.push({pathname:s.pathname,query:{...i,title:t}})})),(0,a.Z)(this,"handleChangeFilter",((t,e)=>{const{router:s,location:a}=this.props,{cursor:n,page:i,...r}=a.query;let o=r.team;"teams"===t&&(o=e.size?[...e]:"");let l=r.status;"status"===t&&(l=e.size?[...e]:""),s.push({pathname:a.pathname,query:{...r,status:l,team:0===o.length?"":o}})}))}getEndpoints(){const{params:t,location:e}=this.props,{query:s}=e,a=(0,_.g2)(s.status);return 1===a.length&&(s.status=a),s.team=(0,_.LI)(s.team),s.expand=["original_alert_rule"],[["incidentList",`/organizations/${null==t?void 0:t.orgId}/incidents/`,{query:s}]]}async onLoadAllEndpointsSuccess(){const{incidentList:t}=this.state;if(!t||0!==t.length)return void this.setState({hasAlertRule:!0,firstVisitShown:!1});this.setState({loading:!0});const{params:e,location:s,organization:a}=this.props,n=(await this.api.requestPromise(`/organizations/${null==e?void 0:e.orgId}/alert-rules/`,{method:"GET",query:s.query})).length>0;if(n)return void this.setState({hasAlertRule:n,firstVisitShown:!1,loading:!1});const i=await(0,r.vu)(this.api,{organizationId:a.id,feature:"alert_stream"}),o=!(null!=i&&i.dismissedTime);o&&(0,r.Xt)(this.api,{feature:"alert_stream",organizationId:a.id,status:"dismissed"}),this.setState({hasAlertRule:n,firstVisitShown:o,loading:!1})}get projectsFromIncidents(){const{incidentList:t}=this.state;return[...new Set(null==t?void 0:t.map((t=>{let{projects:e}=t;return e})).flat())]}tryRenderOnboarding(){const{firstVisitShown:t}=this.state,{organization:e}=this.props;if(!t)return null;const s=(0,z.BX)(i.Fragment,{children:[(0,z.tZ)(p.ZP,{size:"small",external:!0,href:H,children:(0,v.t)("View Features")}),(0,z.tZ)(c.Z,{organization:e,iconProps:{size:"xs"},size:"small",priority:"primary",referrer:"alert_stream",children:(0,v.t)("Create Alert")})]});return(0,z.tZ)(D,{actions:s})}renderLoading(){return this.renderBody()}renderList(){var t;const{loading:e,incidentList:s,incidentListPageLinks:a,hasAlertRule:n}=this.state,{params:{orgId:r},organization:o}=this.props,l=0===(null==s?void 0:s.length)&&void 0===n,d=e||l;return(0,z.BX)(i.Fragment,{children:[null!==(t=this.tryRenderOnboarding())&&void 0!==t?t:(0,z.tZ)(x.KB,{isLoading:d,isEmpty:0===(null==s?void 0:s.length),emptyMessage:(0,v.t)("No incidents exist for the current query."),emptyAction:(0,z.tZ)(B,{children:(0,v._N)("Learn more about [link:Metric Alerts]",{link:(0,z.tZ)(h.Z,{href:H})})}),headers:[(0,v.t)("Alert Rule"),(0,v.t)("Triggered"),(0,v.t)("Duration"),(0,v.t)("Project"),(0,v.t)("Alert ID"),(0,v.t)("Team")],children:(0,z.tZ)(b.Z,{orgId:r,slugs:this.projectsFromIncidents,children:t=>{let{initiallyLoaded:e,projects:a}=t;return s.map((t=>(0,z.tZ)(T.Z,{projectsLoaded:e,projects:a,incident:t,orgId:r,organization:o},t.id)))}})}),(0,z.tZ)(g.Z,{pageLinks:a})]})}renderBody(){const{params:t,organization:e,router:s,location:a}=this.props,{orgId:n}=t;return(0,z.tZ)(Z.Z,{title:(0,v.t)("Alerts"),orgSlug:n,children:(0,z.BX)(u.Z,{organization:e,showDateSelector:!1,hideGlobalHeader:!0,children:[(0,z.tZ)(j.Z,{organization:e,router:s,activeTab:"stream",projectSlugs:this.projectsFromIncidents}),(0,z.tZ)(m.uT,{children:(0,z.BX)(m.or,{fullWidth:!0,children:[!this.tryRenderOnboarding()&&(0,z.BX)(i.Fragment,{children:[(0,z.tZ)(q,{showIcon:!0,children:(0,v.t)("This page only shows metric alerts.")}),(0,z.tZ)(S.Z,{location:a,onChangeFilter:this.handleChangeFilter,onChangeSearch:this.handleChangeSearch,hasStatusFilters:!0})]}),this.renderList()]})})]})})}}class R extends i.Component{componentDidMount(){this.trackView()}componentDidUpdate(t){var e,s;(null===(e=t.location.query)||void 0===e?void 0:e.status)!==(null===(s=this.props.location.query)||void 0===s?void 0:s.status)&&this.trackView()}trackView(){const{organization:t}=this.props;(0,w.Z)("alert_stream.viewed",{organization:t})}renderNoAccess(){return(0,z.tZ)(m.uT,{children:(0,z.tZ)(m.or,{fullWidth:!0,children:(0,z.tZ)(l.Z,{type:"warning",children:(0,v.t)("You don't have access to this feature")})})})}render(){const{organization:t}=this.props;return(0,z.tZ)(o.Z,{features:["organizations:incidents"],organization:t,hookName:"feature-disabled:alerts-page",renderDisabled:this.renderNoAccess,children:(0,z.tZ)(O,{...this.props})})}}R.displayName="IncidentsListContainer";const q=(0,n.Z)(l.Z,{target:"e12ryirh1"})("margin-bottom:",(0,y.Z)(1.5),";"),B=(0,n.Z)("p",{target:"e12ryirh0"})("font-size:",(t=>t.theme.fontSizeLarge),";"),C=(0,f.Z)(R)},"./app/views/alerts/list/row.tsx":(t,e,s)=>{s.d(e,{K:()=>_,Z:()=>k});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("../node_modules/react/index.js"),i=s("../node_modules/moment/moment.js"),r=s.n(i),o=s("./app/components/avatar/actorAvatar.tsx"),l=s("./app/components/duration.tsx"),d=s("./app/components/errorBoundary.tsx"),p=s("./app/components/idBadge/index.tsx"),c=s("./app/components/links/link.tsx"),m=s("./app/components/tag.tsx"),h=s("./app/components/timeSince.tsx"),u=s("./app/locale.tsx"),g=s("./app/stores/teamStore.tsx"),x=s("./app/styles/overflowEllipsis.tsx"),Z=s("./app/styles/space.tsx"),v=s("./app/utils/dates.tsx"),y=s("./app/utils/getDynamicText.tsx"),w=s("./app/views/alerts/rules/details/constants.tsx"),b=s("./app/views/alerts/types.tsx"),f=s("./app/views/alerts/utils/index.tsx"),S=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _=t=>{const{timeWindow:e}=t.alertRule,s=60*e*1e3,a=s*w.U2,n=s*w.UC,i=r().utc(),o=r().utc(t.dateStarted),l=t.dateClosed?r().utc(t.dateClosed):r()(i),d=Math.max(l.diff(o),3*s),p=Math.min(n,Math.max(a,d)),c=r().duration(p/2);return{start:(0,v.v5)(o.subtract(c)),end:(0,v.v5)(r().min(l.add(c),i))}};function j(t){var e;let{incident:s,projectsLoaded:a,projects:i,organization:o}=t;const p=s.projects[0],x=r()(s.dateStarted),Z=r().duration(r()(s.dateClosed||new Date).diff(x)).as("seconds"),v=(0,n.useMemo)((()=>i.find((t=>t.slug===p))),[p,i]),w={pathname:(0,f.Gu)(o,s),query:{alert:s.identifier}},_=null===(e=s.alertRule.owner)||void 0===e?void 0:e.split(":")[1];let j="";var k,D;_&&(j=null!==(k=null===(D=g.Z.getById(_))||void 0===D?void 0:D.name)&&void 0!==k?k:"");const T=_?{type:"team",id:_,name:j}:null;return(0,S.BX)(d.Z,{children:[(0,S.tZ)(A,{"data-test-id":"alert-title",children:(0,S.tZ)(c.Z,{to:w,children:s.title})}),(0,S.tZ)(E,{children:(0,y.Z)({value:(0,S.tZ)(h.Z,{date:s.dateStarted,extraShort:!0}),fixed:"1w ago"})}),(0,S.tZ)(E,{children:s.status===b.vt.CLOSED?(0,S.tZ)(l.Z,{seconds:(0,y.Z)({value:Z,fixed:1200})}):(0,S.tZ)(m.Z,{type:"warning",children:(0,u.t)("Still Active")})}),(0,S.tZ)(X,{avatarSize:18,project:a?v:{slug:p}}),(0,S.BX)(E,{children:["#",s.id]}),(0,S.tZ)(z,{children:T?(0,S.BX)(n.Fragment,{children:[(0,S.tZ)(N,{actor:T,size:24,hasTooltip:!1})," ",(0,S.tZ)(L,{children:T.name})]}):"-"})]})}j.displayName="AlertListRow";const A=(0,a.Z)("div",{target:"ehehgaq5"})(x.Z," min-width:130px;"),E=(0,a.Z)("div",{target:"ehehgaq4"})({name:"1s45tu0",styles:"white-space:nowrap;font-variant-numeric:tabular-nums"}),X=(0,a.Z)(p.Z,{target:"ehehgaq3"})({name:"ozd7xs",styles:"flex-shrink:0"}),z=(0,a.Z)("div",{target:"ehehgaq2"})(x.Z," display:flex;align-items:center;"),L=(0,a.Z)("span",{target:"ehehgaq1"})(x.Z,";"),N=(0,a.Z)(o.Z,{target:"ehehgaq0"})("margin-right:",(0,Z.Z)(1),";"),k=j},"./app/views/alerts/rules/details/constants.tsx":(t,e,s)=>{s.d(e,{ud:()=>i,N7:()=>r,v3:()=>o,e2:()=>l,UC:()=>d,U2:()=>p});var a=s("./app/locale.tsx"),n=s("./app/views/alerts/incidentRules/types.tsx");const i={[n.XH.SIX_HOURS]:(0,a.t)("Last 6 hours"),[n.XH.ONE_DAY]:(0,a.t)("Last 24 hours"),[n.XH.THREE_DAYS]:(0,a.t)("Last 3 days"),[n.XH.SEVEN_DAYS]:(0,a.t)("Last 7 days")},r="7d",o=[{label:(0,a.t)("Last 6 hours"),value:n.XH.SIX_HOURS},{label:(0,a.t)("Last 24 hours"),value:n.XH.ONE_DAY},{label:(0,a.t)("Last 3 days"),value:n.XH.THREE_DAYS},{label:(0,a.t)("Last 7 days"),value:n.XH.SEVEN_DAYS},{label:(0,a.t)("Last 14 days"),value:n.XH.FOURTEEN_DAYS}],l={[n.XH.SIX_HOURS]:6*n.Tb.ONE_HOUR*60*1e3,[n.XH.ONE_DAY]:60*n.Tb.ONE_DAY*1e3,[n.XH.THREE_DAYS]:3*n.Tb.ONE_DAY*60*1e3,[n.XH.SEVEN_DAYS]:7*n.Tb.ONE_DAY*60*1e3,[n.XH.FOURTEEN_DAYS]:14*n.Tb.ONE_DAY*60*1e3},d=(n.XH.FOURTEEN_DAYS,1e4),p=150},"./images/spot/alerts-empty-state.svg":(t,e,s)=>{t.exports=s.p+"assets/alerts-empty-state.4d03bc7c2675b8facd23.svg"}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_list_index_tsx.f3c0aa42a5cb5e2b0c07ebe77dde8075.js.map