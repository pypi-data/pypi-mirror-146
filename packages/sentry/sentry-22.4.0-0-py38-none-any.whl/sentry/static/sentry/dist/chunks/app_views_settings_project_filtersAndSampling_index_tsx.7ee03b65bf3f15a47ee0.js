(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_project_filtersAndSampling_index_tsx"],{"./app/components/actions/menuItemActionLink.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/react/index.js"),n("./app/components/actions/actionLink.tsx")),o=n("./app/components/menuItem.tsx"),i=n("./app/styles/overflowEllipsis.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{className:t,...n}=e;return(0,a.tZ)(o.Z,{noAnchor:!0,withBorder:!0,disabled:n.disabled,className:t,children:(0,a.tZ)(d,{...n})})}l.displayName="MenuItemActionLink";const d=(0,s.Z)(r.Z,{target:"e18s0uh10"})("color:",(e=>e.theme.textColor),";",i.Z," &:hover{color:",(e=>e.theme.textColor),";}.dropdown-menu>li>&,.dropdown-menu>span>li>&{&.disabled:hover{background:",(e=>e.theme.background),";}}"),c=l},"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>i}),n("../node_modules/react/index.js");var s=n("./app/components/asyncComponent.tsx"),r=n("./app/components/sentryDocumentTitle.tsx"),o=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends s.Z{getTitle(){return""}render(){return(0,o.tZ)(r.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/organization/permissionAlert.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l}),n("../node_modules/react/index.js");var s=n("./app/components/acl/access.tsx"),r=n("./app/components/alert.tsx"),o=n("./app/locale.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=e=>{let{access:t=["org:write"],...n}=e;return(0,i.tZ)(s.Z,{access:t,children:e=>{let{hasAccess:t}=e;return!t&&(0,i.tZ)(r.Z,{type:"warning",showIcon:!0,...n,children:(0,o.t)("These settings can only be edited by users with the organization owner or manager role.")})}})};a.displayName="PermissionAlert";const l=a},"./app/views/settings/project/filtersAndSampling/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>tn});var s=n("./app/components/acl/access.tsx"),r=n("./app/components/acl/feature.tsx"),o=n("./app/components/acl/featureDisabled.tsx"),i=n("./app/components/panels/index.tsx"),a=n("./app/locale.tsx"),l=n("./app/utils/withOrganization.tsx"),d=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),u=n("../node_modules/lodash/partition.js"),p=n.n(u),m=n("./app/actionCreators/indicator.tsx"),h=n("./app/actionCreators/modal.tsx"),E=n("./app/components/alert.tsx"),g=n("./app/components/links/externalLink.tsx");let R,_,S,y,T;!function(e){e.TRACE="trace",e.TRANSACTION="transaction",e.ERROR="error"}(R||(R={})),function(e){e.NOT="not",e.OR="or",e.AND="and"}(_||(_={})),function(e){e.GLOB_MATCH="glob",e.EQUAL="eq",e.CUSTOM="custom"}(S||(S={})),function(e){e.TRACE_RELEASE="trace.release",e.TRACE_ENVIRONMENT="trace.environment",e.TRACE_USER_ID="trace.user.id",e.TRACE_USER_SEGMENT="trace.user.segment",e.TRACE_TRANSACTION="trace.transaction",e.EVENT_RELEASE="event.release",e.EVENT_ENVIRONMENT="event.environment",e.EVENT_USER_ID="event.user.id",e.EVENT_USER_SEGMENT="event.user.segment",e.EVENT_LOCALHOST="event.is_local_ip",e.EVENT_WEB_CRAWLERS="event.web_crawlers",e.EVENT_BROWSER_EXTENSIONS="event.has_bad_browser_extensions",e.EVENT_TRANSACTION="event.transaction",e.EVENT_IP_ADDRESSES="event.client_ip",e.EVENT_LEGACY_BROWSER="event.legacy_browser",e.EVENT_ERROR_MESSAGES="event.error_messages",e.EVENT_CSP="event.csp"}(y||(y={})),function(e){e.IE_PRE_9="ie_pre_9",e.IE9="ie9",e.IE10="ie10",e.IE11="ie11",e.SAFARI_PRE_6="safari_pre_6",e.OPERA_PRE_15="opera_pre_15",e.OPERA_MINI_PRE_8="opera_mini_pre_8",e.ANDROID_PRE_4="android_pre_4"}(T||(T={}));var A=n("./app/utils/withProject.tsx"),N=n("./app/views/asyncView.tsx"),Z=n("./app/views/settings/components/settingsPageHeader.tsx"),b=n("./app/views/settings/components/text/textBlock.tsx"),f=n("./app/views/settings/organization/permissionAlert.tsx"),x=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),v=n("../node_modules/@sentry/minimal/esm/index.js"),w=n("./app/utils/theme.tsx");const C="https://docs.sentry.io/product/data-management-settings/filtering/",I={[T.IE_PRE_9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 8 and lower")},[T.IE9]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 9")},[T.IE10]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 10")},[T.IE11]:{icon:"internet-explorer",title:(0,a.t)("Internet Explorer version 11")},[T.SAFARI_PRE_6]:{icon:"safari",title:(0,a.t)("Safari version 5 and lower")},[T.OPERA_PRE_15]:{icon:"opera",title:(0,a.t)("Opera version 14 and lower")},[T.OPERA_MINI_PRE_8]:{icon:"opera",title:(0,a.t)("Opera Mini version 8 and lower")},[T.ANDROID_PRE_4]:{icon:"android",title:(0,a.t)("Android version 3 and lower")}};function O(e){switch(e){case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return(0,a.t)("Environment");case y.TRACE_RELEASE:case y.EVENT_RELEASE:return(0,a.t)("Release");case y.EVENT_USER_ID:case y.TRACE_USER_ID:return(0,a.t)("User Id");case y.EVENT_USER_SEGMENT:case y.TRACE_USER_SEGMENT:return(0,a.t)("User Segment");case y.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Browser Extensions");case y.EVENT_LOCALHOST:return(0,a.t)("Localhost");case y.EVENT_WEB_CRAWLERS:return(0,a.t)("Web Crawlers");case y.EVENT_LEGACY_BROWSER:return(0,a.t)("Legacy Browser");case y.EVENT_TRANSACTION:case y.TRACE_TRANSACTION:return(0,a.t)("Transaction");case y.EVENT_ERROR_MESSAGES:return(0,a.t)("Error Message");case y.EVENT_CSP:return(0,a.t)("Content Security Policy");case y.EVENT_IP_ADDRESSES:return(0,a.t)("IP Address");default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),null}}const V=(0,x.iv)("[role='document']{overflow:initial;}@media (min-width: ",w.ZP.breakpoints[0],"){width:100%;max-width:700px;}","");let j;function k(e){switch(e){case y.EVENT_LEGACY_BROWSER:return(0,a.t)("Match all selected legacy browsers below");case y.EVENT_BROWSER_EXTENSIONS:return(0,a.t)("Match all browser extensions");case y.EVENT_LOCALHOST:return(0,a.t)("Match all localhosts");case y.EVENT_WEB_CRAWLERS:return(0,a.t)("Match all web crawlers");case y.EVENT_USER_ID:case y.TRACE_USER_ID:return(0,a.t)("ex. 4711 (Multiline)");case y.EVENT_USER_SEGMENT:case y.TRACE_USER_SEGMENT:return(0,a.t)("ex. paid, common (Multiline)");case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return(0,a.t)("ex. prod, dev");case y.TRACE_RELEASE:case y.EVENT_RELEASE:return(0,a.t)("ex. 1*, [I3].[0-9].*");case y.EVENT_IP_ADDRESSES:return(0,a.t)("ex. 127.0.0.1 or 10.0.0.0/8 (Multiline)");case y.EVENT_CSP:return(0,a.t)("ex. file://*, example.com (Multiline)");case y.EVENT_ERROR_MESSAGES:return(0,a.t)("ex. TypeError* (Multiline)");case y.TRACE_TRANSACTION:case y.EVENT_TRANSACTION:return(0,a.t)('ex. "page-load"');default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}function M(e){var t,n;if(e.category===y.EVENT_BROWSER_EXTENSIONS||e.category===y.EVENT_WEB_CRAWLERS||e.category===y.EVENT_LOCALHOST)return{op:S.EQUAL,name:e.category,value:!0};if(e.category===y.EVENT_LEGACY_BROWSER)return{op:S.CUSTOM,name:e.category,value:null!==(n=e.legacyBrowsers)&&void 0!==n?n:[]};const s=(null!==(t=e.match)&&void 0!==t?t:"").split("\n").filter((e=>!!e.trim())).map((e=>e.trim()));return e.category===y.EVENT_IP_ADDRESSES||e.category===y.EVENT_ERROR_MESSAGES||e.category===y.EVENT_CSP?{op:S.CUSTOM,name:e.category,value:s}:e.category===y.EVENT_RELEASE||e.category===y.TRACE_RELEASE||e.category===y.EVENT_TRANSACTION||e.category===y.TRACE_TRANSACTION?{op:S.GLOB_MATCH,name:e.category,value:s}:e.category===y.TRACE_USER_ID||e.category===y.EVENT_USER_ID?{op:S.EQUAL,name:e.category,value:s,options:{ignoreCase:!1}}:{op:S.EQUAL,name:e.category,value:s,options:{ignoreCase:!0}}}!function(e){e.ALL="all",e.MATCH_CONDITIONS="match-conditions"}(j||(j={}));const D=(0,a.t)("An internal error occurred while saving dynamic sampling rule");var L=n("../node_modules/lodash/isEqual.js"),P=n.n(L),B=n("./app/utils.tsx"),U=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),z=n("./app/components/button.tsx"),W=n("./app/components/buttonBar.tsx"),X=n("./app/components/dropdownAutoComplete/index.tsx"),F=n("./app/components/dropdownButton.tsx"),G=n("./app/components/forms/numberField.tsx"),$=n("./app/components/menuItem.tsx"),H=n("./app/components/tooltip.tsx"),q=n("./app/icons/iconCheckmark.tsx"),Y=n("./app/styles/space.tsx"),Q=n("./app/views/settings/components/emptyMessage.tsx"),K=n("./app/components/forms/field/fieldRequiredBadge.tsx"),J=n("./app/components/forms/textareaField.tsx"),ee=n("./app/icons/iconDelete.tsx"),te=n("../node_modules/react-select/dist/chunk-80640036.browser.esm.js"),ne=n("./app/actionCreators/tags.tsx"),se=n("./app/components/forms/selectField.tsx"),re=n("./app/utils/useApi.tsx"),oe=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function ie(e){let{orgSlug:t,projectId:n,category:s,onChange:r,value:o}=e;const i=(0,re.Z)(),[l,d]=(0,c.useState)([]);(0,c.useEffect)((()=>{!async function(){if(u)try{const e=await(0,ne.Fo)(i,t,u,null,[n]);d(e)}catch{}}()}),[]);const u=function(){switch(s){case y.TRACE_RELEASE:case y.EVENT_RELEASE:return"release";case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return"environment";case y.TRACE_TRANSACTION:case y.EVENT_TRANSACTION:return"transaction";default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}(),p=o?o.split(",").filter((e=>!l.some((t=>t.value===e)))).map((e=>({value:e}))):[];return(0,oe.tZ)(le,{name:"match","aria-label":function(){switch(s){case y.TRACE_RELEASE:case y.EVENT_RELEASE:return(0,a.t)("Search or add a release");case y.TRACE_ENVIRONMENT:case y.EVENT_ENVIRONMENT:return(0,a.t)("Search or add an environment");case y.TRACE_TRANSACTION:case y.EVENT_TRANSACTION:return(0,a.t)("Search or add a transaction");default:return v.Tb(new Error("Unknown dynamic sampling condition inner name")),""}}(),options:[...p,...l].map((e=>({value:e.value,label:e.value}))),value:null==o?void 0:o.split(","),onChange:e=>{r(null==e?void 0:e.join(","))},styles:{menu:e=>({...e,wordBreak:"break-all"})},components:{SelectContainer:e=>(0,oe.tZ)(te.y.SelectContainer,{...e,innerProps:{...e.innerProps,"data-test-id":`autocomplete-${u}`}}),MultiValue:e=>(0,oe.tZ)(te.y.MultiValue,{...e,innerProps:{...e.innerProps,"data-test-id":"multivalue"}}),Option:e=>(0,oe.tZ)(te.y.Option,{...e,innerProps:{...e.innerProps,"data-test-id":"option"}})},formatCreateLabel:e=>(0,a._N)('Add "[newLabel]"',{newLabel:e}),placeholder:k(s),inline:!1,multiple:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0,creatable:!0,allowClear:!0})}ie.displayName="AutoComplete";const ae=ie,le=(0,U.Z)(se.Z,{target:"e1it57gq0"})({name:"1d3w5wq",styles:"width:100%"});var de=n("../node_modules/lodash/intersection.js"),ce=n.n(de),ue=n("../node_modules/lodash/uniq.js"),pe=n.n(ue),me=n("../node_modules/lodash/xor.js"),he=n.n(me);function Ee(e){let{selectedRowsCount:t,columnsCount:n,isPageSelected:s,isAllSelected:r,onSelectAllRows:o,onUnselectAllRows:i,bulkLimit:l,allRowsCount:d,className:u}=e;if(d&&d<=t||!s)return null;const{noticeText:p,actionText:m}=function(e,t){return(0,B.ri)(e)?t&&e>t?{noticeText:(0,a._N)("Selected up to the first [count] items.",{count:t}),actionText:(0,a._N)("Select the first [count] items.",{count:t})}:{noticeText:(0,a._N)("Selected all [count] items.",{count:e}),actionText:(0,a._N)("Select all [count] items.",{count:e})}:{noticeText:(0,a.t)("Selected all items across all pages."),actionText:(0,a.t)("Select all items across all pages.")}}(d,l);return(0,oe.tZ)(ge,{columnsCount:n,className:u,children:r?(0,oe.BX)(c.Fragment,{children:[p," ",(0,oe.tZ)(Re,{priority:"link",onClick:i,children:(0,a.t)("Cancel selection.")})]}):(0,oe.BX)(c.Fragment,{children:[(0,a.tn)("%s item on this page selected.","%s items on this page selected.",t)," ",(0,oe.tZ)(Re,{priority:"link",onClick:o,children:m})]})})}Ee.displayName="BulkNotice";const ge=(0,U.Z)((e=>{let{columnsCount:t,...n}=e;return(0,oe.tZ)(i.aU,{...n})}),{target:"e1cwk49q1"})("grid-column:span ",(e=>e.columnsCount),";text-align:center;"),Re=(0,U.Z)(z.ZP,{target:"e1cwk49q0"})("&,&:hover,&:active,&:focus{color:",(e=>e.theme.textColor),";border:none;border-radius:0;border-bottom:1px dotted ",(e=>e.theme.textColor),";padding-bottom:1px;font-size:15px;}"),_e=Ee;class Se extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",this.getInitialState()),(0,d.Z)(this,"handleRowToggle",(e=>{this.setState((t=>({selectedIds:he()(t.selectedIds,[e]),isAllSelected:!1})))})),(0,d.Z)(this,"handleAllRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState({selectedIds:e?[...t]:[],isAllSelected:e})})),(0,d.Z)(this,"handlePageRowsToggle",(e=>{const{pageIds:t}=this.props;this.setState((n=>({selectedIds:e?pe()([...n.selectedIds,...t]):n.selectedIds.filter((e=>!t.includes(e))),isAllSelected:!1})))}))}getInitialState(){const{defaultSelectedIds:e,pageIds:t}=this.props;return{selectedIds:ce()(null!=e?e:[],t),isAllSelected:!1}}static getDerivedStateFromProps(e,t){return{...t,selectedIds:ce()(t.selectedIds,e.pageIds)}}componentDidUpdate(e,t){var n,s;P()(t,this.state)||null===(n=(s=this.props).onChange)||void 0===n||n.call(s,this.state)}render(){const{pageIds:e,children:t,columnsCount:n,allRowsCount:s,bulkLimit:r}=this.props,{selectedIds:o,isAllSelected:i}=this.state,a=e.length>0&&e.every((e=>o.includes(e)));return t({selectedIds:o,isAllSelected:i,isPageSelected:a,onRowToggle:this.handleRowToggle,onAllRowsToggle:this.handleAllRowsToggle,onPageRowsToggle:this.handlePageRowsToggle,renderBulkNotice:()=>(0,oe.tZ)(_e,{allRowsCount:s,selectedRowsCount:o.length,onUnselectAllRows:()=>this.handleAllRowsToggle(!1),onSelectAllRows:()=>this.handleAllRowsToggle(!0),columnsCount:n,isPageSelected:a,isAllSelected:i,bulkLimit:r})})}}Se.displayName="BulkController";const ye=Se;var Te=n("./app/components/switchButton.tsx");const Ae=Object.values(T);function Ne(e){let{onChange:t,selectedLegacyBrowsers:n=[]}=e;return(0,oe.tZ)(ye,{pageIds:Ae,defaultSelectedIds:n,allRowsCount:Ae.length,onChange:function(e){let{selectedIds:n}=e;t(n)},columnsCount:0,children:e=>{let{selectedIds:t,onRowToggle:n,onPageRowsToggle:s,isPageSelected:r}=e;return(0,oe.BX)(be,{children:[(0,a.t)("All browsers"),(0,oe.tZ)(Te.Z,{size:"lg",isActive:r,toggle:()=>{s(!r)}},"switch"),Ae.map((e=>{const{icon:s,title:r}=I[e];return(0,oe.BX)(c.Fragment,{children:[(0,oe.BX)(fe,{children:[(0,oe.tZ)(xe,{className:`icon-${s}`,"data-test-id":`icon-${s}`}),r]}),(0,oe.tZ)(Te.Z,{size:"lg",isActive:t.includes(e),toggle:()=>n(e)})]},e)}))]})}})}Ne.displayName="LegacyBrowsers";const Ze=Ne,be=(0,U.Z)("div",{target:"evvj4pe2"})("grid-column:1/-1;display:grid;grid-template-columns:1fr max-content;gap:",(0,Y.Z)(2),";font-size:",(e=>e.theme.fontSizeLarge),";color:",(e=>e.theme.gray400),";padding-top:",(0,Y.Z)(2),";padding-bottom:",(0,Y.Z)(1),";"),fe=(0,U.Z)("div",{target:"evvj4pe1"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,Y.Z)(1),";color:",(e=>e.theme.gray500),";"),xe=(0,U.Z)("div",{target:"evvj4pe0"})({name:"1bjfr92",styles:"width:24px;height:24px;background-repeat:no-repeat;background-position:center;background-size:24px 24px;flex-shrink:0"});function ve(e){let{conditions:t,orgSlug:n,projectId:s,onDelete:r,onChange:o}=e;return(0,oe.tZ)(c.Fragment,{children:t.map(((e,t)=>{let{category:i,match:l,legacyBrowsers:d}=e;const c=i===y.EVENT_LEGACY_BROWSER,u=i===y.EVENT_BROWSER_EXTENSIONS||i===y.EVENT_LOCALHOST||i===y.EVENT_WEB_CRAWLERS||c,p=i===y.EVENT_ENVIRONMENT||i===y.EVENT_RELEASE||i===y.EVENT_TRANSACTION||i===y.TRACE_ENVIRONMENT||i===y.TRACE_RELEASE||i===y.TRACE_TRANSACTION;return(0,oe.BX)(Ce,{children:[(0,oe.tZ)(Oe,{children:(0,oe.BX)("span",{children:[O(i),(0,oe.tZ)(K.Z,{})]})}),(0,oe.tZ)(Ve,{children:!u&&(p?(0,oe.tZ)(ae,{category:i,orgSlug:n,projectId:s,value:l,onChange:e=>o(t,"match",e)}):(0,oe.tZ)(ke,{name:"match",value:l,onChange:e=>o(t,"match",e),placeholder:k(i),inline:!1,rows:1,autosize:!0,hideControlState:!0,flexibleControlStateSize:!0,required:!0,stacked:!0}))}),(0,oe.tZ)(je,{children:(0,oe.tZ)(z.ZP,{onClick:()=>r(t),icon:(0,oe.tZ)(ee.F,{}),"aria-label":(0,a.t)("Delete Condition")})}),c&&(0,oe.tZ)(Ze,{selectedLegacyBrowsers:d,onChange:e=>{o(t,"legacyBrowsers",e)}})]},t)}))})}ve.displayName="Conditions";const we=ve,Ce=(0,U.Z)("div",{target:"ep8w7uu5"})("display:grid;grid-template-columns:1fr minmax(0, 1fr);align-items:flex-start;padding:",(0,Y.Z)(1)," ",(0,Y.Z)(2),";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.gray100),";}@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:0.6fr minmax(0, 1fr) max-content;}"),Ie=(0,U.Z)("div",{target:"ep8w7uu4"})({name:"38ghps",styles:"min-height:40px;display:inline-flex;align-items:center"}),Oe=(0,U.Z)(Ie,{target:"ep8w7uu3"})("padding-right:",(0,Y.Z)(2),";line-height:16px;"),Ve=(0,U.Z)(Ie,{target:"ep8w7uu2"})("padding-top:",(0,Y.Z)(1),";grid-column:1/-1;grid-row:2/2;",(e=>!e.children&&"display: none"),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-column:auto;grid-row:auto;padding-top:0;}"),je=(0,U.Z)(Ie,{target:"ep8w7uu1"})("justify-content:flex-end;padding-left:",(0,Y.Z)(1),";"),ke=(0,U.Z)(J.Z,{target:"ep8w7uu0"})({name:"1fz47qv",styles:"padding-bottom:0;width:100%"});function Me(e){let{Header:t,Body:n,Footer:s,closeModal:r,title:o,emptyMessage:l,conditionCategories:d,api:u,organization:p,project:h,onSubmitSuccess:E,onSubmit:g,onChange:R,extraFields:_,rule:S}=e;const[T,A]=(0,c.useState)(function(){if(S){const{condition:e,sampleRate:t}=S,{inner:n}=e;return{conditions:n.map((e=>{let{name:t,value:n}=e;return Array.isArray(n)?n.every((e=>!!I[e]))?{category:t,legacyBrowsers:n}:{category:t,match:n.join("\n")}:{category:t}})),sampleRate:100*t,errors:{}}}return{conditions:[],sampleRate:null,errors:{}}}());(0,c.useEffect)((()=>{T.errors.sampleRate&&A({...T,errors:{...T.errors,sampleRate:void 0}})}),[T.sampleRate]),(0,c.useEffect)((()=>{null==R||R(T)}),[T]);const{errors:N,conditions:Z,sampleRate:b}=T;async function f(e,t){try{const t=await u.requestPromise(`/projects/${p.slug}/${h.slug}/`,{method:"PUT",data:{dynamicSampling:{rules:e}}});E(t,S?(0,a.t)("Successfully edited dynamic sampling rule"):(0,a.t)("Successfully added dynamic sampling rule")),r()}catch(e){!function(e){"string"!=typeof e?"sampleRate"===e.type?A({...T,errors:{...N,sampleRate:e.message}}):(0,m.Iw)(e.message):(0,m.Iw)(e)}(function(e,t){var n,s,r;const o=null===(n=e.responseJSON)||void 0===n?void 0:n.detail;if(o)return o[0];const i=e.responseJSON;if(!i)return D;const l=null!==(s=null===(r=i.dynamicSampling)||void 0===r?void 0:r.rules[t])&&void 0!==s?s:{},[d,c]=Object.entries(l)[0];return"sampleRate"===d?{type:"sampleRate",message:(0,a.t)("Ensure this value is a floating number between 0 and 100")}:D}(e,t))}}const x=!(0,B.ri)(b)||!(null==Z||!Z.find((e=>{var t;return e.category===y.EVENT_LEGACY_BROWSER?!(null!==(t=e.legacyBrowsers)&&void 0!==t?t:[]).length:e.category!==y.EVENT_LOCALHOST&&e.category!==y.EVENT_BROWSER_EXTENSIONS&&e.category!==y.EVENT_WEB_CRAWLERS&&!e.match})));return(0,oe.BX)(c.Fragment,{children:[(0,oe.tZ)(t,{closeButton:!0,children:(0,oe.tZ)("h4",{children:o})}),(0,oe.tZ)(n,{children:(0,oe.BX)(Le,{children:[_,(0,oe.BX)(Ue,{children:[(0,oe.BX)(Be,{hasButtons:!0,children:[(0,a.t)("Conditions"),(0,oe.tZ)(X.Z,{onSelect:e=>{var t;t=e.value,A({...T,conditions:[...Z,{category:t,match:""}]})},alignMenu:"right",items:d.map((e=>{const t=Z.some((t=>t.category===e[0]));return{value:e[0],"data-test-id":"condition",disabled:t,label:(0,oe.tZ)(H.ZP,{title:(0,a.t)("This condition has already been added"),disabled:!t,children:(0,oe.tZ)(Pe,{disabled:t,children:e[1]})})}})),children:e=>{let{isOpen:t}=e;return(0,oe.tZ)(F.Z,{isOpen:t,size:"small",children:(0,a.t)("Add Condition")})}})]}),(0,oe.tZ)(i.N,{children:Z.length?(0,oe.tZ)(we,{conditions:Z,onDelete:function(e){const t=[...Z];t.splice(e,1),A({...T,conditions:t})},onChange:function(e,t,n){const s=[...Z];s[e][t]=n,A({...T,conditions:s})},orgSlug:p.slug,projectId:h.id}):(0,oe.tZ)(Q.Z,{icon:(0,oe.tZ)(q.D,{isCircled:!0,size:"xl"}),children:l})})]}),(0,oe.tZ)(G.Z,{label:`${(0,a.t)("Sampling Rate")} %`,name:"sampleRate",onChange:e=>{A({...T,sampleRate:e?Number(e):null})},placeholder:"%",value:b,inline:!1,hideControlState:!N.sampleRate,error:N.sampleRate,showHelpInTooltip:!0,stacked:!0,required:!0})]})}),(0,oe.tZ)(s,{children:(0,oe.BX)(W.ZP,{gap:1,children:[(0,oe.tZ)(z.ZP,{onClick:r,children:(0,a.t)("Cancel")}),(0,oe.tZ)(z.ZP,{priority:"primary",onClick:()=>g({conditions:Z,sampleRate:b,submitRules:f}),title:x?(0,a.t)("Required fields must be filled out"):void 0,disabled:x,children:(0,a.t)("Save Rule")})]})})]})}Me.displayName="RuleModal";const De=Me,Le=(0,U.Z)("div",{target:"e1mf53z03"})("display:grid;gap:",(0,Y.Z)(2),";"),Pe=(0,U.Z)($.Z,{target:"e1mf53z02"})("color:",(e=>e.theme.textColor),";font-size:",(e=>e.theme.fontSizeMedium),";font-weight:400;text-transform:none;span{padding:0;}"),Be=(0,U.Z)(i.V9,{target:"e1mf53z01"})("padding-right:",(0,Y.Z)(2),";"),Ue=(0,U.Z)(i.s_,{target:"e1mf53z00"})({name:"1ykowef",styles:"margin-bottom:0"});function ze(e){let{rule:t,errorRules:n,transactionRules:s,...r}=e;return(0,oe.tZ)(De,{...r,title:t?(0,a.t)("Edit Error Sampling Rule"):(0,a.t)("Add Error Sampling Rule"),emptyMessage:(0,a.t)("Apply sampling rate to all errors"),conditionCategories:[[y.EVENT_RELEASE,(0,a.t)("Release")],[y.EVENT_ENVIRONMENT,(0,a.t)("Environment")],[y.EVENT_USER_ID,(0,a.t)("User Id")],[y.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[y.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[y.EVENT_LOCALHOST,(0,a.t)("Localhost")],[y.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browser")],[y.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[y.EVENT_IP_ADDRESSES,(0,a.t)("IP Address")],[y.EVENT_CSP,(0,a.t)("Content Security Policy")],[y.EVENT_ERROR_MESSAGES,(0,a.t)("Error Message")],[y.EVENT_TRANSACTION,(0,a.t)("Transaction")]],rule:t,onSubmit:function(e){let{sampleRate:r,conditions:o,submitRules:i}=e;if(!(0,B.ri)(r))return;const a={id:0,type:R.ERROR,condition:{op:_.AND,inner:o.length?o.map(M):[]},sampleRate:r/100},l=t?[...n.map((e=>P()(e,t)?a:e)),...s]:[...n,a,...s],d=l.findIndex((e=>e===a));i(l,d)}})}ze.displayName="ErrorRuleModal";const We=ze;var Xe=n("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),Fe=n("./app/components/checkboxFancy/checkboxFancy.tsx"),Ge=n("./app/components/forms/field/index.tsx");function $e(e){let{rule:t,errorRules:n,transactionRules:s,...r}=e;const o=(0,Xe.u)(),[i,l]=(0,c.useState)(!t||t.type===R.TRACE),[d,u]=(0,c.useState)(!(null==t||!t.condition.inner.length));return(0,oe.tZ)(De,{...r,title:t?(0,a.t)("Edit Transaction Sampling Rule"):(0,a.t)("Add Transaction Sampling Rule"),emptyMessage:(0,a.t)("Apply sampling rate to all transactions"),conditionCategories:i?[[y.TRACE_RELEASE,(0,a.t)("Release")],[y.TRACE_ENVIRONMENT,(0,a.t)("Environment")],[y.TRACE_USER_ID,(0,a.t)("User Id")],[y.TRACE_USER_SEGMENT,(0,a.t)("User Segment")],[y.TRACE_TRANSACTION,(0,a.t)("Transaction")]]:[[y.EVENT_RELEASE,(0,a.t)("Release")],[y.EVENT_ENVIRONMENT,(0,a.t)("Environment")],[y.EVENT_USER_ID,(0,a.t)("User Id")],[y.EVENT_USER_SEGMENT,(0,a.t)("User Segment")],[y.EVENT_BROWSER_EXTENSIONS,(0,a.t)("Browser Extensions")],[y.EVENT_LOCALHOST,(0,a.t)("Localhost")],[y.EVENT_LEGACY_BROWSER,(0,a.t)("Legacy Browser")],[y.EVENT_WEB_CRAWLERS,(0,a.t)("Web Crawlers")],[y.EVENT_IP_ADDRESSES,(0,a.t)("IP Address")],[y.EVENT_CSP,(0,a.t)("Content Security Policy")],[y.EVENT_ERROR_MESSAGES,(0,a.t)("Error Message")],[y.EVENT_TRANSACTION,(0,a.t)("Transaction")]],rule:t,onSubmit:function(e){let{sampleRate:r,conditions:o,submitRules:a}=e;if(!(0,B.ri)(r))return;const l={id:0,type:i?R.TRACE:R.TRANSACTION,condition:{op:_.AND,inner:o.length?o.map(M):[]},sampleRate:r/100},d=t?s.map((e=>P()(e,t)?l:e)):[...s,l],[c,u]=p()(d,(e=>e.type===R.TRACE)),m=[...n,...c,...u],h=m.findIndex((e=>e===l));a(m,h)},onChange:function(e){let{conditions:t}=e;u(!!t.length)},extraFields:(0,oe.tZ)(Ge.Z,{label:(0,a.t)("Tracing"),inline:!1,flexibleControlStateSize:!0,stacked:!0,showHelpInTooltip:!0,children:(0,oe.tZ)(H.ZP,{title:(0,a.t)("This field can only be edited if there are no match conditions"),disabled:!d,popperStyle:(0,x.iv)("@media (min-width: ",o.breakpoints[0],"){max-width:370px;}",""),children:(0,oe.BX)(qe,{onClick:d?void 0:()=>l(!i),children:[(0,oe.tZ)(Ye,{isChecked:i,isDisabled:d}),(0,a._N)("Include all related transactions by trace ID. This can span across multiple projects. All related errors will remain. [link:Learn more about tracing].",{link:(0,oe.tZ)(g.Z,{href:C,onClick:e=>e.stopPropagation()})})]})})})})}$e.displayName="TransactionRuleModal";const He=$e,qe=(0,U.Z)("div",{target:"ejbmws91"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,Y.Z)(1),";cursor:",(e=>e.onClick?"pointer":"not-allowed"),";"),Ye=(0,U.Z)(Fe.Z,{target:"ejbmws90"})("margin-top:",(0,Y.Z)(.5),";");function Qe(e){let{type:t,...n}=e;return"error"===t?(0,oe.tZ)(We,{...n}):(0,oe.tZ)(He,{...n})}Qe.displayName="Modal";const Ke=Qe;var Je=n("./app/styles/overflowEllipsis.tsx"),et=n("../node_modules/react-dom/profiling.js"),tt=n("../node_modules/@dnd-kit/core/dist/core.esm.js"),nt=n("../node_modules/@dnd-kit/sortable/dist/sortable.esm.js");function st(e){let{value:t,dragging:n,index:s,transform:r,listeners:o,sorting:i,transition:a,forwardRef:l,attributes:d,renderItem:c,wrapperStyle:u,innerWrapperStyle:p}=e;return(0,oe.tZ)(at,{ref:l,style:{...u,transition:a,"--translate-x":r?`${Math.round(r.x)}px`:void 0,"--translate-y":r?`${Math.round(r.y)}px`:void 0,"--scale-x":null!=r&&r.scaleX?`${r.scaleX}`:void 0,"--scale-y":null!=r&&r.scaleY?`${r.scaleY}`:void 0},children:(0,oe.tZ)(lt,{style:p,children:c({dragging:Boolean(n),sorting:Boolean(i),listeners:o,transform:r,transition:a,value:t,index:s,attributes:d})})})}st.displayName="Item";const rt=st,ot="0 0 0 calc(1px / var(--scale-x, 1)) rgba(63, 63, 68, 0.05)",it=`${ot}, 0 1px calc(3px / var(--scale-x, 1)) 0 rgba(34, 33, 81, 0.15)`,at=(0,U.Z)("div",{target:"e1puudz31"})("transform:translate3d(var(--translate-x, 0), var(--translate-y, 0), 0) scaleX(var(--scale-x, 1)) scaleY(var(--scale-y, 1));transform-origin:0 0;touch-action:manipulation;--box-shadow:",it,";--box-shadow-picked-up:",ot,",-1px 0 15px 0 rgba(34, 33, 81, 0.01),0px 15px 15px 0 rgba(34, 33, 81, 0.25);"),lt=(0,U.Z)("div",{target:"e1puudz30"})("background-color:",(e=>e.theme.background),";animation:pop 200ms cubic-bezier(0.18, 0.67, 0.6, 1.22);box-shadow:var(--box-shadow-picked-up);opacity:1;:focus{box-shadow:0 0px 4px 1px rgba(76, 159, 254, 1),",it,";}@keyframes pop{0%{transform:scale(1);box-shadow:var(--box-shadow);}100%{box-shadow:var(--box-shadow-picked-up);}}");function dt(e){let{id:t,index:n,renderItem:s,disabled:r,wrapperStyle:o,innerWrapperStyle:i}=e;const{attributes:a,isSorting:l,isDragging:d,listeners:c,setNodeRef:u,overIndex:p,transform:m,transition:h}=(0,nt.nB)({id:t,disabled:r});return(0,oe.tZ)(rt,{forwardRef:u,value:t,sorting:l,renderItem:s,index:n,transform:m,transition:h,listeners:c,attributes:a,wrapperStyle:o({id:t,index:n,isDragging:d,isSorting:l}),innerWrapperStyle:i({id:t,index:n,isDragging:d,isSorting:l,overIndex:p,isDragOverlay:!1})})}dt.displayName="SortableItem";const ct=dt;class ut extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",{}),(0,d.Z)(this,"handleChangeActive",(e=>{this.setState({activeId:e})}))}render(){const{activeId:e}=this.state,{items:t,onUpdateItems:n,renderItem:s,disabled:r,wrapperStyle:o,innerWrapperStyle:i}=this.props,a=t.indexOf.bind(t),l=e?a(e):-1;return(0,oe.BX)(tt.LB,{onDragStart:e=>{let{active:t}=e;t&&this.handleChangeActive(t.id)},onDragEnd:e=>{let{over:s}=e;if(this.handleChangeActive(void 0),s){const e=a(s.id);l!==e&&n({activeIndex:l,overIndex:e,reorderedItems:(0,nt.Rp)(t,l,e)})}},onDragCancel:()=>this.handleChangeActive(void 0),children:[(0,oe.tZ)(nt.Fo,{items:t,strategy:nt.qw,children:t.map(((e,t)=>(0,oe.tZ)(ct,{id:e,index:t,renderItem:s,disabled:r,wrapperStyle:o,innerWrapperStyle:i},e)))}),(0,et.createPortal)((0,oe.tZ)(tt.y9,{children:e?(0,oe.tZ)(rt,{value:t[l],renderItem:s,wrapperStyle:o({id:t[l],index:l,isDragging:!0,isSorting:!1}),innerWrapperStyle:i({id:t[l],index:l,isSorting:null!==e,isDragging:!0,overIndex:-1,isDragOverlay:!0})}):null}),document.body)]})}}ut.displayName="DraggableList",(0,d.Z)(ut,"defaultProps",{disabled:!1,wrapperStyle:()=>({}),innerWrapperStyle:()=>({})});const pt=ut;var mt=n("./app/icons/iconGrabbable.tsx");const ht=e=>`\n> * {\n  :nth-child(-n + 5):nth-child(5n - 1) {\n    text-align: center;\n  }\n  @media (max-width: ${e.breakpoints[0]}) {\n    :nth-child(5n - 4),\n    :nth-child(5n - 3) {\n      display: none;\n    }\n  }\n}\ngrid-template-columns: 2fr 1.5fr 1fr;\n@media (min-width: ${e.breakpoints[0]}) {\n  grid-template-columns: 0.5fr 1.5fr 2fr 1.5fr 1fr;\n}\n@media (min-width: ${e.breakpoints[2]}) {\n  grid-template-columns: 0.5fr 2fr 2.5fr 2fr 1.5fr;\n}\n@media (min-width: ${e.breakpoints[3]}) {\n  grid-template-columns: 0.5fr 2fr 3fr 2fr 1fr;\n}\n`;var Et=n("./app/components/actions/menuItemActionLink.tsx"),gt=n("./app/components/confirm.tsx"),Rt=n("./app/components/dropdownLink.tsx"),_t=n("./app/icons/index.tsx");const St=(0,a.t)("Are you sure you wish to delete this dynamic sampling rule?"),yt=(0,a.t)("You do not have permission to delete dynamic sampling rules."),Tt=(0,a.t)("You do not have permission to edit dynamic sampling rules.");function At(e){let{disabled:t,onEditRule:n,onDeleteRule:s,onOpenMenuActions:r,isMenuActionsOpen:o}=e;return(0,oe.BX)(c.Fragment,{children:[(0,oe.BX)(Zt,{gap:1,children:[(0,oe.tZ)(z.ZP,{"aria-label":(0,a.t)("Edit Rule"),size:"small",onClick:n,icon:(0,oe.tZ)(_t.yl,{}),disabled:t,title:t?Tt:void 0}),(0,oe.tZ)(gt.Z,{priority:"danger",message:St,onConfirm:s,disabled:t,children:(0,oe.tZ)(z.ZP,{"aria-label":(0,a.t)("Delete Rule"),size:"small",icon:(0,oe.tZ)(_t.Fz,{}),title:t?yt:void 0})})]}),(0,oe.BX)(bt,{caret:!1,customTitle:(0,oe.tZ)(z.ZP,{"aria-label":(0,a.t)("Actions"),icon:(0,oe.tZ)(_t.YR,{size:"sm"}),size:"xsmall",onClick:r}),isOpen:o,anchorRight:!0,children:[(0,oe.tZ)(Et.Z,{shouldConfirm:!1,icon:(0,oe.tZ)(_t.Dj,{size:"xs"}),title:(0,a.t)("Edit"),onClick:t?e=>{null==e||e.stopPropagation()}:n,disabled:t,children:(0,oe.tZ)(H.ZP,{disabled:!t,title:Tt,containerDisplayMode:"block",children:(0,a.t)("Edit")})}),(0,oe.tZ)(Et.Z,{onAction:s,message:St,icon:(0,oe.tZ)(_t.Dj,{size:"xs"}),title:(0,a.t)("Delete"),disabled:t,priority:"danger",shouldConfirm:!0,children:(0,oe.tZ)(H.ZP,{disabled:!t,title:yt,containerDisplayMode:"block",children:(0,a.t)("Delete")})})]})]})}At.displayName="Actions";const Nt=At,Zt=(0,U.Z)(W.ZP,{target:"e1a3egcn1"})("justify-content:flex-end;flex:1;display:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:grid;}"),bt=(0,U.Z)(Rt.Z,{target:"e1a3egcn0"})("display:flex;align-items:center;transition:none;@media (min-width: ",(e=>e.theme.breakpoints[2]),"){display:none;}"),ft=function(e){let{condition:t}=e;function n(e){var t,n;return Array.isArray(e)?(0,oe.tZ)(c.Fragment,{children:[...e].map(((t,n)=>{var s,r;return(0,oe.BX)(c.Fragment,{children:[(0,oe.tZ)(wt,{children:null!==(s=null===(r=I[t])||void 0===r?void 0:r.title)&&void 0!==s?s:t}),n!==e.length-1&&(0,oe.tZ)(Ct,{children:","})]},t)}))}):(0,oe.tZ)(wt,{children:null!==(t=null===(n=I[String(e)])||void 0===n?void 0:n.title)&&void 0!==t?t:String(e)})}if(t.op===_.AND){const{inner:e}=t;return e.length?(0,oe.tZ)(xt,{children:e.map(((e,t)=>{let{value:s,name:r}=e;return(0,oe.BX)("div",{children:[(0,oe.tZ)(vt,{children:O(r)}),n(s)]},t)}))}):(0,oe.tZ)(vt,{children:(0,a.t)("All")})}return v.Tb(new Error("Unknown dynamic sampling condition operator")),null},xt=(0,U.Z)("div",{target:"e5dv9sd3"})("display:grid;gap:",(0,Y.Z)(1.5),";"),vt=(0,U.Z)("span",{target:"e5dv9sd2"})("margin-right:",(0,Y.Z)(1),";"),wt=(0,U.Z)("span",{target:"e5dv9sd1"})("word-break:break-all;white-space:pre-wrap;color:",(e=>e.theme.gray300),";"),Ct=(0,U.Z)(wt,{target:"e5dv9sd0"})("padding-right:",(0,Y.Z)(.5),";");function It(e){let{sampleRate:t}=e;return(0,oe.tZ)(Vt,{children:100*t+"%"})}It.displayName="SampleRate";const Ot=It,Vt=(0,U.Z)("div",{target:"e17oa8sb0"})({name:"1h3cbh4",styles:"white-space:pre-wrap;word-break:break-all"}),jt=function(e){let{type:t}=e;switch(t){case R.ERROR:return(0,oe.tZ)(kt,{children:(0,a.t)("Errors only")});case R.TRANSACTION:return(0,oe.tZ)(Mt,{children:(0,a.t)("Individual transactions")});case R.TRACE:return(0,oe.tZ)(Mt,{children:(0,a.t)("Transaction traces")});default:return v.Tb(new Error("Unknown dynamic sampling rule type")),null}},kt=(0,U.Z)("div",{target:"enki2wy1"})("color:",(e=>e.theme.pink300),";white-space:pre-wrap;"),Mt=(0,U.Z)(kt,{target:"enki2wy0"})("color:",(e=>e.theme.linkColor),";");class Dt extends c.Component{constructor(){super(...arguments),(0,d.Z)(this,"state",{isMenuActionsOpen:!1}),(0,d.Z)(this,"handleChangeMenuAction",(()=>{this.setState((e=>({isMenuActionsOpen:!e.isMenuActionsOpen})))}))}componentDidMount(){this.checkMenuActionsVisibility()}componentDidUpdate(){this.checkMenuActionsVisibility()}checkMenuActionsVisibility(){const{dragging:e,sorting:t}=this.props,{isMenuActionsOpen:n}=this.state;(e||t)&&n&&this.setState({isMenuActionsOpen:!1})}render(){const{rule:e,onEditRule:t,onDeleteRule:n,disabled:s,listeners:r,grabAttributes:o}=this.props,{type:i,condition:l,sampleRate:d}=e,{isMenuActionsOpen:c}=this.state;return(0,oe.BX)(Pt,{children:[(0,oe.tZ)(Ut,{children:(0,oe.tZ)(H.ZP,{title:s?(0,a.t)("You do not have permission to reorder dynamic sampling rules."):void 0,children:(0,oe.tZ)(Wt,{...r,disabled:s,...o,children:(0,oe.tZ)(mt.L,{})})})}),(0,oe.tZ)(Bt,{children:(0,oe.tZ)(jt,{type:i})}),(0,oe.tZ)(Bt,{children:(0,oe.tZ)(ft,{condition:l})}),(0,oe.tZ)(zt,{children:(0,oe.tZ)(Ot,{sampleRate:d})}),(0,oe.tZ)(Bt,{children:(0,oe.tZ)(Nt,{onEditRule:t,onDeleteRule:n,disabled:s,onOpenMenuActions:this.handleChangeMenuAction,isMenuActionsOpen:c})})]})}}Dt.displayName="Rule";const Lt=Dt,Pt=(0,U.Z)("div",{target:"el3sh2r4"})("display:grid;align-items:center;",(e=>ht(e.theme)),">*{overflow:visible;:nth-child(5n){justify-content:flex-end;}}"),Bt=(0,U.Z)("div",{target:"el3sh2r3"})("display:flex;align-items:center;padding:",(0,Y.Z)(2),";cursor:default;white-space:pre-wrap;word-break:break-all;"),Ut=(0,U.Z)(Bt,{target:"el3sh2r2"})({name:"m8x70k",styles:"cursor:inherit;[role='button']{cursor:grab;}"}),zt=(0,U.Z)(Bt,{target:"el3sh2r1"})({name:"1gtpzmm",styles:"text-align:center;justify-content:center"}),Wt=(0,U.Z)("div",{target:"el3sh2r0"})((e=>e.disabled&&`\n    color: ${e.theme.disabled};\n    cursor: not-allowed;\n  `),";outline:none;");class Xt extends c.PureComponent{constructor(){super(...arguments),(0,d.Z)(this,"state",{rules:[]}),(0,d.Z)(this,"handleUpdateRules",(e=>{let{activeIndex:t,overIndex:n,reorderedItems:s}=e;const{rules:r}=this.state,o=s.map((e=>r.find((t=>String(t.id)===e)))).filter((e=>!!e)),i=r[t].type,l=r[n].type;i!==R.TRACE||l!==R.TRANSACTION?i!==R.TRANSACTION||l!==R.TRACE?this.setState({rules:o}):(0,m.Iw)((0,a.t)("Individual transactions rules cannot be above transaction traces rules")):(0,m.Iw)((0,a.t)("Transaction traces rules cannot be under individual transactions rules"))}))}componentDidMount(){this.getRules()}componentDidUpdate(e){P()(e.rules,this.props.rules)?P()(this.props.rules,this.state.rules)||this.handleUpdateRulesParent():this.getRules()}getRules(){this.setState({rules:this.props.rules})}handleUpdateRulesParent(){const{onUpdateRules:e}=this.props,{rules:t}=this.state;e(t)}render(){const{onEditRule:e,onDeleteRule:t,disabled:n,emptyMessage:s}=this.props,{rules:r}=this.state;return(0,oe.tZ)(Gt,{headers:["",(0,a.t)("Type"),(0,a.t)("Conditions"),(0,a.t)("Rate"),""],isEmpty:!r.length,emptyMessage:s,children:(0,oe.tZ)(pt,{disabled:n,items:r.map((e=>String(e.id))),onUpdateItems:this.handleUpdateRules,wrapperStyle:e=>{let{isDragging:t,isSorting:n,index:s}=e;return t?{cursor:"grabbing"}:n?{}:{transform:"none",transformOrigin:"0","--box-shadow":"none","--box-shadow-picked-up":"none",overflow:"visible",position:"relative",zIndex:r.length-s,cursor:"default"}},renderItem:s=>{let{value:o,listeners:i,attributes:a,dragging:l,sorting:d}=s;const c=r.find((e=>String(e.id)===o));return c?(0,oe.tZ)(Lt,{rule:c,onEditRule:e(c),onDeleteRule:t(c),disabled:n,listeners:i,grabAttributes:a,dragging:l,sorting:d}):null}})})}}Xt.displayName="Rules";const Ft=Xt,Gt=(0,U.Z)(i.KB,{target:"e15ewxcp0"})("overflow:visible;margin-bottom:0;border:none;border-bottom-right-radius:0;border-bottom-left-radius:0;",(e=>ht(e.theme)),">*{",Je.Z,";:not(:last-child){border-bottom:1px solid ",(e=>e.theme.border),";}:nth-child(n + 6){",(e=>e.isEmpty?"\n              display: block;\n              grid-column: 1/-1;\n            ":"\n              display: grid;\n              grid-column: 1/-1;\n              padding: 0;\n            "),";}}");function $t(e){let{rules:t,onAddRule:n,onEditRule:s,onDeleteRule:r,onUpdateRules:o,isErrorPanel:l,disabled:d}=e;const c=l?(0,a.t)("error"):(0,a.t)("transaction");return(0,oe.BX)(i.s_,{children:[(0,oe.tZ)(Ft,{rules:t,onEditRule:s,onDeleteRule:r,disabled:d,onUpdateRules:o,emptyMessage:(0,a.t)("There are no %s rules to display",c)}),(0,oe.tZ)(qt,{children:(0,oe.BX)(Yt,{gap:1,children:[(0,oe.tZ)(z.ZP,{href:C,external:!0,children:(0,a.t)("Read the docs")}),(0,oe.tZ)(Qt,{priority:"primary",onClick:n,disabled:d,title:d?(0,a.t)("You do not have permission to add dynamic sampling rules."):void 0,children:(0,a.t)("Add %s rule",c)})]})})]})}$t.displayName="RulesPanel";const Ht=$t,qt=(0,U.Z)(i.jH,{target:"e1lsth6w2"})("padding:",(0,Y.Z)(1)," ",(0,Y.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;align-items:center;justify-content:flex-end;}"),Yt=(0,U.Z)(W.ZP,{target:"e1lsth6w1"})("@media (max-width: ",(e=>e.theme.breakpoints[0]),"){grid-auto-flow:row;grid-row-gap:",(0,Y.Z)(1),";}"),Qt=(0,U.Z)(z.ZP,{target:"e1lsth6w0"})("@media (max-width: ",(e=>e.theme.breakpoints[0]),"){width:100%;}");class Kt extends N.Z{constructor(){super(...arguments),(0,d.Z)(this,"successfullySubmitted",((e,t)=>{this.setState({projectDetails:e}),t&&(0,m.S9)(t)})),(0,d.Z)(this,"handleOpenRule",((e,t)=>()=>{const{organization:n,project:s}=this.props,{errorRules:r,transactionRules:o}=this.state;return(0,h.openModal)((i=>(0,oe.tZ)(Ke,{...i,type:e,api:this.api,organization:n,project:s,rule:t,errorRules:r,transactionRules:o,onSubmitSuccess:this.successfullySubmitted})),{modalCss:V})})),(0,d.Z)(this,"handleAddRule",(e=>()=>{"errorRules"!==e?this.handleOpenRule("transaction")():this.handleOpenRule("error")()})),(0,d.Z)(this,"handleEditRule",(e=>()=>{e.type!==R.ERROR?this.handleOpenRule("transaction",e)():this.handleOpenRule("error",e)()})),(0,d.Z)(this,"handleDeleteRule",(e=>()=>{const{errorRules:t,transactionRules:n}=this.state,s=[...e.type===R.ERROR?t.filter((t=>t.id!==e.id)):t,...e.type!==R.ERROR?n.filter((t=>t.id!==e.id)):n];this.submitRules(s,(0,a.t)("Successfully deleted dynamic sampling rule"),(0,a.t)("An error occurred while deleting dynamic sampling rule"))})),(0,d.Z)(this,"handleUpdateRules",(e=>{var t;if(!e.length)return;const{errorRules:n,transactionRules:s}=this.state;(null===(t=e[0])||void 0===t?void 0:t.type)!==R.ERROR?this.submitRules([...n,...e]):this.submitRules([...e,...s])}))}getTitle(){return(0,a.t)("Filters & Sampling")}getDefaultState(){return{...super.getDefaultState(),errorRules:[],transactionRules:[],projectDetails:null}}getEndpoints(){const{organization:e,project:t}=this.props;return[["projectDetails",`/projects/${e.slug}/${t.slug}/`]]}componentDidMount(){this.getRules()}componentDidUpdate(e,t){t.projectDetails===this.state.projectDetails||this.getRules()}getRules(){var e;const{projectDetails:t}=this.state;if(!t)return;const{dynamicSampling:n}=t,s=null!==(e=null==n?void 0:n.rules)&&void 0!==e?e:[],[r,o]=p()(s,(e=>e.type===R.ERROR));this.setState({errorRules:r,transactionRules:o})}async submitRules(e,t,n){const{organization:s,project:r}=this.props;try{const n=await this.api.requestPromise(`/projects/${s.slug}/${r.slug}/`,{method:"PUT",data:{dynamicSampling:{rules:e}}});this.successfullySubmitted(n,t)}catch(e){this.getRules(),n&&(0,m.Iw)(n)}}renderBody(){const{errorRules:e,transactionRules:t}=this.state,{hasAccess:n,organization:s}=this.props,r=!n,o=[...e,...t].some((e=>e.condition.op!==_.AND));return o?(0,oe.tZ)(E.Z,{type:"error",children:(0,a.t)("A condition operator has been found that is not yet supported.")}):(0,oe.BX)(c.Fragment,{children:[(0,oe.tZ)(Z.Z,{title:this.getTitle()}),(0,oe.tZ)(f.Z,{}),(0,oe.tZ)(b.Z,{children:(0,a._N)("Manage the inbound data you want to store. To change the sampling rate or rate limits, [link:update your SDK configuration]. The rules added below will apply on top of your SDK configuration. Any new rule may take a few minutes to propagate.",{link:(0,oe.tZ)(g.Z,{href:C})})}),s.features.includes("filters-and-sampling-error-rules")&&(0,oe.tZ)(Ht,{rules:e,disabled:r,onAddRule:this.handleAddRule("errorRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules,isErrorPanel:!0}),(0,oe.tZ)(b.Z,{children:(0,a.t)("Rules for traces should precede rules for individual transactions.")}),(0,oe.tZ)(Ht,{rules:t,disabled:r,onAddRule:this.handleAddRule("transactionRules"),onEditRule:this.handleEditRule,onDeleteRule:this.handleDeleteRule,onUpdateRules:this.handleUpdateRules})]})}}const Jt=(0,A.Z)(Kt),en=e=>{let{organization:t,...n}=e;return(0,oe.tZ)(r.Z,{features:["filters-and-sampling"],organization:t,renderDisabled:()=>(0,oe.tZ)(o.Z,{alert:i.aU,features:t.features,featureName:(0,a.t)("Filters & Sampling")}),children:(0,oe.tZ)(s.Z,{organization:t,access:["project:write"],children:e=>{let{hasAccess:s}=e;return(0,oe.tZ)(Jt,{...n,hasAccess:s,organization:t})}})})};en.displayName="Index";const tn=(0,l.Z)(en)},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),r=n("../node_modules/lodash/_arrayIncludes.js"),o=n("../node_modules/lodash/_arrayIncludesWith.js"),i=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,d){var c=-1,u=r,p=!0,m=e.length,h=[],E=t.length;if(!m)return h;n&&(t=i(t,a(n))),d?(u=o,p=!1):t.length>=200&&(u=l,p=!1,t=new s(t));e:for(;++c<m;){var g=e[c],R=null==n?g:n(g);if(g=d||0!==g?g:0,p&&R==R){for(var _=E;_--;)if(t[_]===R)continue e;h.push(g)}else u(t,R,d)||h.push(g)}return h}},"../node_modules/lodash/_baseIntersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_SetCache.js"),r=n("../node_modules/lodash/_arrayIncludes.js"),o=n("../node_modules/lodash/_arrayIncludesWith.js"),i=n("../node_modules/lodash/_arrayMap.js"),a=n("../node_modules/lodash/_baseUnary.js"),l=n("../node_modules/lodash/_cacheHas.js"),d=Math.min;e.exports=function(e,t,n){for(var c=n?o:r,u=e[0].length,p=e.length,m=p,h=Array(p),E=1/0,g=[];m--;){var R=e[m];m&&t&&(R=i(R,a(t))),E=d(R.length,E),h[m]=!n&&(t||u>=120&&R.length>=120)?new s(m&&R):void 0}R=e[0];var _=-1,S=h[0];e:for(;++_<u&&g.length<E;){var y=R[_],T=t?t(y):y;if(y=n||0!==y?y:0,!(S?l(S,T):c(g,T,n))){for(m=p;--m;){var A=h[m];if(!(A?l(A,T):c(e[m],T,n)))continue e}S&&S.push(T),g.push(y)}}return g}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_baseDifference.js"),r=n("../node_modules/lodash/_baseFlatten.js"),o=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var i=e.length;if(i<2)return i?o(e[0]):[];for(var a=-1,l=Array(i);++a<i;)for(var d=e[a],c=-1;++c<i;)c!=a&&(l[a]=s(l[a]||d,e[c],t,n));return o(r(l,1),t,n)}},"../node_modules/lodash/_castArrayLikeObject.js":(e,t,n)=>{var s=n("../node_modules/lodash/isArrayLikeObject.js");e.exports=function(e){return s(e)?e:[]}},"../node_modules/lodash/intersection.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayMap.js"),r=n("../node_modules/lodash/_baseIntersection.js"),o=n("../node_modules/lodash/_baseRest.js"),i=n("../node_modules/lodash/_castArrayLikeObject.js"),a=o((function(e){var t=s(e,i);return t.length&&t[0]===e[0]?r(t):[]}));e.exports=a},"../node_modules/lodash/xor.js":(e,t,n)=>{var s=n("../node_modules/lodash/_arrayFilter.js"),r=n("../node_modules/lodash/_baseRest.js"),o=n("../node_modules/lodash/_baseXor.js"),i=n("../node_modules/lodash/isArrayLikeObject.js"),a=r((function(e){return o(s(e,i))}));e.exports=a}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_project_filtersAndSampling_index_tsx.8ba0ffc06972146bbc4dad131c2245c6.js.map