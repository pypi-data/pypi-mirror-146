{"version":3,"file":"chunks/app_components_editableText_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/utils/useKeyPress.tsx","webpack:///./app/components/editableText.tsx","webpack:///./app/utils/useOnClickOutside.tsx"],"sourcesContent":["import {useEffect, useState} from 'react';\n\n/**\n * Hook to detect when a specific key is being pressed\n */\nfunction useKeyPress(targetKey: React.KeyboardEvent['key']) {\n  const [keyPressed, setKeyPressed] = useState(false);\n\n  useEffect(() => {\n    function downHandler({key}: KeyboardEvent) {\n      if (key === targetKey) {\n        setKeyPressed(true);\n      }\n    }\n\n    function upHandler({key}: KeyboardEvent) {\n      if (key === targetKey) {\n        setKeyPressed(false);\n      }\n    }\n    window.addEventListener('keydown', downHandler);\n    window.addEventListener('keyup', upHandler);\n\n    return () => {\n      window.removeEventListener('keydown', downHandler);\n      window.removeEventListener('keyup', upHandler);\n    };\n  }, [targetKey]);\n\n  return keyPressed;\n}\n\nexport default useKeyPress;\n","import {useCallback, useEffect, useRef, useState} from 'react';\nimport * as React from 'react';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage, addSuccessMessage} from 'sentry/actionCreators/indicator';\nimport Input from 'sentry/components/forms/controls/input';\nimport TextOverflow from 'sentry/components/textOverflow';\nimport {IconEdit} from 'sentry/icons/iconEdit';\nimport space from 'sentry/styles/space';\nimport {defined} from 'sentry/utils';\nimport useKeypress from 'sentry/utils/useKeyPress';\nimport useOnClickOutside from 'sentry/utils/useOnClickOutside';\n\ntype Props = {\n  onChange: (value: string) => void;\n  value: string;\n  'aria-label'?: string;\n  autoSelect?: boolean;\n  errorMessage?: React.ReactNode;\n  isDisabled?: boolean;\n  maxLength?: number;\n  name?: string;\n  successMessage?: React.ReactNode;\n};\n\nfunction EditableText({\n  value,\n  onChange,\n  name,\n  errorMessage,\n  successMessage,\n  maxLength,\n  isDisabled = false,\n  autoSelect = false,\n  'aria-label': ariaLabel,\n}: Props) {\n  const [isEditing, setIsEditing] = useState(false);\n  const [inputValue, setInputValue] = useState(value);\n\n  const isEmpty = !inputValue.trim();\n\n  const innerWrapperRef = useRef<HTMLDivElement>(null);\n  const labelRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const enter = useKeypress('Enter');\n  const esc = useKeypress('Escape');\n\n  function revertValueAndCloseEditor() {\n    if (value !== inputValue) {\n      setInputValue(value);\n    }\n\n    if (isEditing) {\n      setIsEditing(false);\n    }\n  }\n\n  // check to see if the user clicked outside of this component\n  useOnClickOutside(innerWrapperRef, () => {\n    if (!isEditing) {\n      return;\n    }\n\n    if (isEmpty) {\n      displayStatusMessage('error');\n      return;\n    }\n\n    if (inputValue !== value) {\n      onChange(inputValue);\n      displayStatusMessage('success');\n    }\n\n    setIsEditing(false);\n  });\n\n  const onEnter = useCallback(() => {\n    if (enter) {\n      if (isEmpty) {\n        displayStatusMessage('error');\n        return;\n      }\n\n      if (inputValue !== value) {\n        onChange(inputValue);\n        displayStatusMessage('success');\n      }\n\n      setIsEditing(false);\n    }\n  }, [enter, inputValue, onChange]);\n\n  const onEsc = useCallback(() => {\n    if (esc) {\n      revertValueAndCloseEditor();\n    }\n  }, [esc]);\n\n  useEffect(() => {\n    revertValueAndCloseEditor();\n  }, [isDisabled, value]);\n\n  // focus the cursor in the input field on edit start\n  useEffect(() => {\n    if (isEditing) {\n      const inputElement = inputRef.current;\n      if (defined(inputElement)) {\n        inputElement.focus();\n      }\n    }\n  }, [isEditing]);\n\n  useEffect(() => {\n    if (isEditing) {\n      // if Enter is pressed, save the value and close the editor\n      onEnter();\n      // if Escape is pressed, revert the value and close the editor\n      onEsc();\n    }\n  }, [onEnter, onEsc, isEditing]); // watch the Enter and Escape key presses\n\n  function displayStatusMessage(status: 'error' | 'success') {\n    if (status === 'error') {\n      if (errorMessage) {\n        addErrorMessage(errorMessage);\n      }\n      return;\n    }\n\n    if (successMessage) {\n      addSuccessMessage(successMessage);\n    }\n  }\n\n  function handleInputChange(event: React.ChangeEvent<HTMLInputElement>) {\n    setInputValue(event.target.value);\n  }\n\n  function handleEditClick() {\n    setIsEditing(true);\n  }\n\n  return (\n    <Wrapper isDisabled={isDisabled} isEditing={isEditing}>\n      {isEditing ? (\n        <InputWrapper\n          ref={innerWrapperRef}\n          isEmpty={isEmpty}\n          data-test-id=\"editable-text-input\"\n        >\n          <StyledInput\n            aria-label={ariaLabel}\n            name={name}\n            ref={inputRef}\n            value={inputValue}\n            onChange={handleInputChange}\n            onFocus={event => autoSelect && event.target.select()}\n            maxLength={maxLength}\n          />\n          <InputLabel>{inputValue}</InputLabel>\n        </InputWrapper>\n      ) : (\n        <Label\n          onClick={isDisabled ? undefined : handleEditClick}\n          ref={labelRef}\n          isDisabled={isDisabled}\n          data-test-id=\"editable-text-label\"\n        >\n          <InnerLabel>{inputValue}</InnerLabel>\n          {!isDisabled && <IconEdit />}\n        </Label>\n      )}\n    </Wrapper>\n  );\n}\n\nexport default EditableText;\n\nconst Label = styled('div')<{isDisabled: boolean}>`\n  display: grid;\n  grid-auto-flow: column;\n  align-items: center;\n  gap: ${space(1)};\n  cursor: ${p => (p.isDisabled ? 'default' : 'pointer')};\n`;\n\nconst InnerLabel = styled(TextOverflow)`\n  border-top: 1px solid transparent;\n  border-bottom: 1px dotted ${p => p.theme.gray200};\n`;\n\nconst InputWrapper = styled('div')<{isEmpty: boolean}>`\n  display: inline-block;\n  background: ${p => p.theme.gray100};\n  border-radius: ${p => p.theme.borderRadius};\n  margin: -${space(0.5)} -${space(1)};\n  max-width: calc(100% + ${space(2)});\n`;\n\nconst StyledInput = styled(Input)`\n  border: none !important;\n  background: transparent;\n  height: auto;\n  min-height: 34px;\n  padding: ${space(0.5)} ${space(1)};\n  &,\n  &:focus,\n  &:active,\n  &:hover {\n    box-shadow: none;\n  }\n`;\n\nconst InputLabel = styled('div')`\n  height: 0;\n  opacity: 0;\n  white-space: pre;\n  padding: 0 ${space(1)};\n`;\n\nconst Wrapper = styled('div')<{isDisabled: boolean; isEditing: boolean}>`\n  display: flex;\n\n  ${p =>\n    p.isDisabled &&\n    `\n      ${InnerLabel} {\n        border-bottom-color: transparent;\n      }\n    `}\n`;\n","// hook from https://usehooks.com/useOnClickOutside/\nimport {useEffect} from 'react';\nimport * as React from 'react';\n\nfunction useOnClickOutside<T extends HTMLElement = HTMLElement>(\n  ref: React.RefObject<T>,\n  handler: (event: MouseEvent | TouchEvent) => void\n) {\n  useEffect(\n    () => {\n      const listener = (event: MouseEvent | TouchEvent) => {\n        const el = ref?.current;\n\n        // Do nothing if clicking ref's element or descendent elements\n        if (!el || el.contains(event.target as Node)) {\n          return;\n        }\n\n        handler(event);\n      };\n\n      document.addEventListener('mousedown', listener);\n      document.addEventListener('touchstart', listener);\n      return () => {\n        document.removeEventListener('mousedown', listener);\n        document.removeEventListener('touchstart', listener);\n      };\n    },\n    // Reload only if ref or handler changes\n    [ref, handler]\n  );\n}\n\nexport default useOnClickOutside;\n"],"names":["targetKey","keyPressed","setKeyPressed","useState","useEffect","downHandler","key","upHandler","window","addEventListener","removeEventListener","EditableText","value","onChange","name","errorMessage","successMessage","maxLength","isDisabled","autoSelect","ariaLabel","isEditing","setIsEditing","inputValue","setInputValue","isEmpty","trim","innerWrapperRef","useRef","labelRef","inputRef","enter","useKeypress","esc","revertValueAndCloseEditor","useOnClickOutside","displayStatusMessage","onEnter","useCallback","onEsc","status","addSuccessMessage","addErrorMessage","inputElement","current","defined","focus","Wrapper","InputWrapper","ref","StyledInput","event","target","onFocus","select","InputLabel","Label","onClick","undefined","InnerLabel","space","p","TextOverflow","theme","gray200","gray100","borderRadius","Input","handler","listener","el","contains","document"],"sourceRoot":""}