{"version":3,"file":"chunks/app_views_alerts_edit_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/views/alerts/incidentRules/details.tsx","webpack:///./app/views/alerts/edit.tsx"],"sourcesContent":["import {RouteComponentProps} from 'react-router';\n\nimport {addErrorMessage} from 'sentry/actionCreators/indicator';\nimport {Organization, Project} from 'sentry/types';\nimport {metric} from 'sentry/utils/analytics';\nimport RuleForm from 'sentry/views/alerts/incidentRules/ruleForm';\nimport {IncidentRule} from 'sentry/views/alerts/incidentRules/types';\nimport AsyncView from 'sentry/views/asyncView';\n\ntype RouteParams = {\n  orgId: string;\n  projectId: string;\n  ruleId: string;\n};\n\ntype Props = {\n  onChangeTitle: (data: string) => void;\n  organization: Organization;\n  project: Project;\n  userTeamIds: string[];\n} & RouteComponentProps<RouteParams, {}>;\n\ntype State = {\n  actions: Map<string, any>;\n  rule: IncidentRule; // This is temp\n} & AsyncView['state'];\n\nclass IncidentRulesDetails extends AsyncView<Props, State> {\n  getDefaultState() {\n    return {\n      ...super.getDefaultState(),\n      actions: new Map(),\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {orgId, ruleId} = this.props.params;\n\n    return [['rule', `/organizations/${orgId}/alert-rules/${ruleId}/`]];\n  }\n\n  onRequestSuccess({stateKey, data}) {\n    if (stateKey === 'rule' && data.name) {\n      this.props.onChangeTitle(data.name);\n    }\n  }\n\n  onLoadAllEndpointsSuccess() {\n    const {rule} = this.state;\n    if (rule?.errors) {\n      (rule?.errors || []).map(({detail}) => addErrorMessage(detail, {append: true}));\n    }\n  }\n\n  handleSubmitSuccess = () => {\n    const {router, project} = this.props;\n    const {orgId} = this.props.params;\n\n    metric.endTransaction({name: 'saveAlertRule'});\n    router.push({\n      pathname: `/organizations/${orgId}/alerts/rules/`,\n      query: {project: project.id},\n    });\n  };\n\n  renderBody() {\n    const {ruleId} = this.props.params;\n    const {rule} = this.state;\n\n    return (\n      <RuleForm\n        {...this.props}\n        ruleId={ruleId}\n        rule={rule}\n        onSubmitSuccess={this.handleSubmitSuccess}\n      />\n    );\n  }\n}\n\nexport default IncidentRulesDetails;\n","import {Component, Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport * as Layout from 'sentry/components/layouts/thirds';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\nimport {t} from 'sentry/locale';\nimport {Organization, Project} from 'sentry/types';\nimport trackAdvancedAnalyticsEvent from 'sentry/utils/analytics/trackAdvancedAnalyticsEvent';\nimport Teams from 'sentry/utils/teams';\nimport BuilderBreadCrumbs from 'sentry/views/alerts/builder/builderBreadCrumbs';\nimport IncidentRulesDetails from 'sentry/views/alerts/incidentRules/details';\nimport IssueEditor from 'sentry/views/alerts/issueRuleEditor';\nimport {AlertRuleType} from 'sentry/views/alerts/types';\n\ntype RouteParams = {\n  orgId: string;\n  projectId: string;\n  ruleId: string;\n};\n\ntype Props = RouteComponentProps<RouteParams, {}> & {\n  hasMetricAlerts: boolean;\n  organization: Organization;\n  project: Project;\n};\n\ntype State = {\n  ruleName: string;\n};\n\nclass ProjectAlertsEditor extends Component<Props, State> {\n  state: State = {\n    ruleName: '',\n  };\n\n  componentDidMount() {\n    const {organization, project} = this.props;\n    trackAdvancedAnalyticsEvent('edit_alert_rule.viewed', {\n      organization,\n      project_id: project.id,\n      alert_type: this.getAlertType(),\n    });\n  }\n\n  handleChangeTitle = (ruleName: string) => {\n    this.setState({ruleName});\n  };\n\n  getTitle() {\n    const {ruleName} = this.state;\n    return `${ruleName}`;\n  }\n\n  getAlertType(): AlertRuleType {\n    return location.pathname.includes('/alerts/metric-rules/')\n      ? AlertRuleType.METRIC\n      : AlertRuleType.ISSUE;\n  }\n\n  render() {\n    const {hasMetricAlerts, location, organization, project, routes} = this.props;\n    const alertType = this.getAlertType();\n\n    return (\n      <Fragment>\n        <SentryDocumentTitle\n          title={this.getTitle()}\n          orgSlug={organization.slug}\n          projectSlug={project.slug}\n        />\n        <Layout.Header>\n          <Layout.HeaderContent>\n            <BuilderBreadCrumbs\n              organization={organization}\n              title={t('Edit Alert Rule')}\n              projectSlug={project.slug}\n              routes={routes}\n              location={location}\n            />\n            <Layout.Title>{this.getTitle()}</Layout.Title>\n          </Layout.HeaderContent>\n        </Layout.Header>\n        <EditConditionsBody>\n          <Layout.Main fullWidth>\n            <Teams provideUserTeams>\n              {({teams, initiallyLoaded}) =>\n                initiallyLoaded ? (\n                  <Fragment>\n                    {(!hasMetricAlerts || alertType === 'issue') && (\n                      <IssueEditor\n                        {...this.props}\n                        project={project}\n                        onChangeTitle={this.handleChangeTitle}\n                        userTeamIds={teams.map(({id}) => id)}\n                      />\n                    )}\n                    {hasMetricAlerts && alertType === AlertRuleType.METRIC && (\n                      <IncidentRulesDetails\n                        {...this.props}\n                        project={project}\n                        onChangeTitle={this.handleChangeTitle}\n                        userTeamIds={teams.map(({id}) => id)}\n                      />\n                    )}\n                  </Fragment>\n                ) : (\n                  <LoadingIndicator />\n                )\n              }\n            </Teams>\n          </Layout.Main>\n        </EditConditionsBody>\n      </Fragment>\n    );\n  }\n}\n\nconst EditConditionsBody = styled(Layout.Body)`\n  *:not(img) {\n    max-width: 1000px;\n  }\n`;\n\nexport default ProjectAlertsEditor;\n"],"names":["IncidentRulesDetails","AsyncView","router","project","this","props","orgId","params","metric","name","push","pathname","query","id","getDefaultState","super","actions","Map","getEndpoints","ruleId","onRequestSuccess","stateKey","data","onChangeTitle","onLoadAllEndpointsSuccess","rule","state","errors","map","detail","addErrorMessage","append","renderBody","onSubmitSuccess","handleSubmitSuccess","ProjectAlertsEditor","Component","ruleName","setState","componentDidMount","organization","trackAdvancedAnalyticsEvent","project_id","alert_type","getAlertType","getTitle","location","includes","AlertRuleType","render","hasMetricAlerts","routes","alertType","Fragment","title","orgSlug","slug","projectSlug","t","EditConditionsBody","fullWidth","provideUserTeams","teams","initiallyLoaded","handleChangeTitle","userTeamIds","Layout"],"sourceRoot":""}