{"version":3,"sources":["webpack://idom-client-jupyter/./lib/index.js","webpack://idom-client-jupyter/./lib/widget.js"],"names":[],"mappings":";;;;;;;;AAAA;AACA,0EAAuC;AACvC,6FAA8D;;;;;;;;;;;ACF9D,cAAc,mBAAO,CAAC,oFAAuB;AAC7C,sBAAsB,mBAAO,CAAC,8FAAmB;AACjD,QAAQ,mBAAO,CAAC,6DAAQ;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;AAED,mBAAmB;;AAEnB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kCAAkC,oBAAoB,GAAG,OAAO;AAChE;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,eAAe,8CAA8C;AAC7D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kCAAkC,OAAO;AACzC;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA,kCAAkC,OAAO;AACzC;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"lib_index_js.2dfee2a454ea77fc837b.js","sourcesContent":["// Export widget models and views, and the npm package version number.\nmodule.exports = require(\"./widget.js\");\nmodule.exports[\"version\"] = require(\"../package.json\").version;\n","var widgets = require(\"@jupyter-widgets/base\");\nvar idomClientReact = require(\"idom-client-react\");\nvar _ = require(\"lodash\");\n\nvar IdomModel = widgets.DOMWidgetModel.extend({\n  defaults: _.extend(widgets.DOMWidgetModel.prototype.defaults(), {\n    _model_name: \"IdomModel\",\n    _view_name: \"IdomView\",\n    _model_module: \"idom-client-jupyter\",\n    _view_module: \"idom-client-jupyter\",\n    _model_module_version: \"0.9.0\",\n    _view_module_version: \"0.9.0\",\n  }),\n});\n\nvar _nextViewID = { id: 0 };\n\nconst jupyterServerBaseUrl = (() => {\n  const jupyterConfig = document.getElementById(\"jupyter-config-data\");\n  if (jupyterConfig) {\n    return JSON.parse(jupyterConfig.text)[\"baseUrl\"];\n  }\n  return document.getElementsByTagName(\"body\")[0].getAttribute(\"data-base-url\");\n})();\n\nclass IdomView extends widgets.DOMWidgetView {\n  constructor(options) {\n    super(options);\n    this.render = this.render.bind(this);\n    this.remove = this.remove.bind(this);\n  }\n\n  render() {\n    this.viewID = _nextViewID.id;\n    _nextViewID.id++;\n\n    var saveUpdateHook = (updateHook) => {\n      this.model.on(\"msg:custom\", (msg, buffers) => {\n        if (msg.viewID == this.viewID) {\n          updateHook(...msg.data);\n        }\n      });\n      this.send({\n        type: \"client-ready\",\n        viewID: this.viewID,\n        data: null,\n      });\n    };\n\n    var sendEvent = (event) => {\n      this.send({\n        type: \"dom-event\",\n        viewID: this.viewID,\n        data: event,\n      });\n    };\n\n    let importSourceBaseUrl;\n    if (jupyterServerBaseUrl) {\n      importSourceBaseUrl = concatAndResolveUrl(\n        jupyterServerBaseUrl,\n        \"_idom_web_modules\"\n      );\n    } else {\n      importSourceBaseUrl = this.model.attributes._import_source_base_url;\n    }\n    if (!importSourceBaseUrl) {\n      console.error(\n        \"No Jupyter Server base URL could be discovered and no import source base URL was configured.\"\n      );\n    }\n\n    var loadImportSource = (source, sourceType) => {\n      return import(\n        /* webpackIgnore: true */\n        sourceType == \"NAME\" ? `${importSourceBaseUrl}/${source}` : source\n      );\n    };\n\n    idomClientReact.mountLayout(this.el, {\n      saveUpdateHook,\n      sendEvent,\n      loadImportSource,\n    });\n  }\n\n  remove() {\n    this.send({ type: \"client-removed\", viewID: this.viewID });\n    return super.remove();\n  }\n}\n\nfunction concatAndResolveUrl(url, concat) {\n  var url1 = (url.endsWith(\"/\") ? url.slice(0, -1) : url).split(\"/\");\n  var url2 = concat.split(\"/\");\n  var url3 = [];\n  for (var i = 0, l = url1.length; i < l; i++) {\n    if (url1[i] == \"..\") {\n      url3.pop();\n    } else if (url1[i] == \".\") {\n      continue;\n    } else {\n      url3.push(url1[i]);\n    }\n  }\n  for (var i = 0, l = url2.length; i < l; i++) {\n    if (url2[i] == \"..\") {\n      url3.pop();\n    } else if (url2[i] == \".\") {\n      continue;\n    } else {\n      url3.push(url2[i]);\n    }\n  }\n  return url3.join(\"/\");\n}\n\nmodule.exports = {\n  IdomModel: IdomModel,\n  IdomView: IdomView,\n};\n"],"sourceRoot":""}